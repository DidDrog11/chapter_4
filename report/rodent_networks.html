<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Simons">

<title>Rodent networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="rodent_networks_files/libs/clipboard/clipboard.min.js"></script>
<script src="rodent_networks_files/libs/quarto-html/quarto.js"></script>
<script src="rodent_networks_files/libs/quarto-html/popper.min.js"></script>
<script src="rodent_networks_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="rodent_networks_files/libs/quarto-html/anchor.min.js"></script>
<link href="rodent_networks_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="rodent_networks_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="rodent_networks_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="rodent_networks_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="rodent_networks_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rodent networks</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Simons </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Load packages and data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"00_setup.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>graph_landuse <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"rodent_network.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convert the data to graph and network objects. Species with less than 10 individuals will be grouped as <code>Other</code>. The period of trapping is converted to the <code>Dry</code> or <code>Wet</code> season and <code>village_loc</code> is produced to code for <code>Urban</code> and <code>Rural</code> villages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>rodent_graph <span class="ot">&lt;-</span> <span class="fu">bind_graphs</span>(graph_landuse<span class="sc">$</span>observed_50)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Species with more than 10 nodes</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>retain_rodents <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">V</span>(rodent_graph)<span class="sc">$</span>Species))[<span class="fu">table</span>(<span class="fu">V</span>(rodent_graph)<span class="sc">$</span>Species) <span class="sc">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>rodent_graph <span class="ot">&lt;-</span> rodent_graph <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Season =</span> <span class="fu">case_when</span>(Visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>) <span class="sc">~</span> <span class="st">"Dry"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Wet"</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Species =</span> <span class="fu">case_when</span>(<span class="sc">!</span>Species <span class="sc">%in%</span> retain_rodents <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> Species),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Village_loc =</span> <span class="fu">case_when</span>(Village <span class="sc">==</span> <span class="st">"Lambayama"</span> <span class="sc">~</span> <span class="st">"Urban"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Rural"</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Landuse =</span> <span class="fu">case_when</span>(Landuse <span class="sc">==</span> <span class="st">"Secondary_forest"</span> <span class="sc">~</span> <span class="st">"Forest"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> Landuse),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Serostatus =</span> <span class="fu">case_when</span>(ELISA <span class="sc">==</span> <span class="st">"Equivocal"</span> <span class="sc">~</span> <span class="st">"Negative"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> ELISA))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>rodent_graph <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">simplify</span>(<span class="fu">as.igraph</span>(rodent_graph))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>rodent_net <span class="ot">&lt;-</span> <span class="fu">asNetwork</span>(rodent_graph)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Rodent connected is a subgraph of non-isolated nodes</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>rodent_connected <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(rodent_graph) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">!=</span> to) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">node_is_isolated</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="network-summary-and-descriptives" class="level2">
<h2 class="anchored" data-anchor-id="network-summary-and-descriptives">Network summary and descriptives</h2>
<p>The following is the summary of the network.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print =</span> <span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rodent_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Network attributes:
  vertices = 412
  directed = FALSE
  hyper = FALSE
  loops = FALSE
  multiple = FALSE
  bipartite = FALSE
 total edges = 1120 
   missing edges = 0 
   non-missing edges = 1120 
 density = 0.01322845 

Vertex attributes:

 Age:
   character valued attribute
   attribute summary:
    Adult  Juvenile Not_known 
      333        62        17 

 Contact.radius:
   character valued attribute
   attribute summary:
50m 
412 

 ELISA:
   character valued attribute
   attribute summary:
Negative Positive 
     392       20 

 Landuse:
   character valued attribute
   attribute summary:
Agriculture      Forest     Village 
        259          31         122 

 Month:
   numeric valued attribute
   attribute summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   4.000   4.000   5.733  10.000  12.000 

 Season:
   character valued attribute
   attribute summary:
Dry Wet 
274 138 

 Serostatus:
   character valued attribute
   attribute summary:
Negative Positive 
     392       20 

 Sex:
   character valued attribute
   attribute summary:
Female   Male 
   208    204 

 Species:
   character valued attribute
   attribute summary:
      Crocidura spp Lophuromys sikapusi Mastomys natalensis      Mus minutoides 
                 83                  44                  75                  35 
       Mus musculus               Other         Praomys spp       Rattus rattus 
                 41                  28                  68                  38 
  vertex.names:
   character valued attribute
   412 valid vertex names

 Village:
   character valued attribute
   attribute summary:
   Baiama   Bambawo   Lalehun Lambayama   Seilama 
       45        13       103        61       190 

 Village.locations:
   character valued attribute
   attribute summary:
Rural Urban 
  351    61 

 Village_loc:
   character valued attribute
   attribute summary:
Rural Urban 
  351    61 

 Visit:
   character valued attribute
   attribute summary:
 1  2  3  4  5  6 
45 72 58 80 99 58 

 Year:
   numeric valued attribute
   attribute summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2020    2021    2021    2021    2022    2022 

No edge attributes

Network edgelist matrix:
        [,1] [,2]
   [1,]    3    4
   [2,]    3   13
   [3,]    4   13
   [4,]    5    7
   [5,]    5   10
 [ reached getOption("max.print") -- omitted 1115 rows ]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are 412 individual rodents, with 339 ties between individuals for an overall density of 0.004. The attributes that will be used will include species, landuse, season, serostatus and village_loc. We have 7 named species, with one other category. The most commonly trapped species were the Crocidura, followed by Mastomys natalensis, Praomys and Lophuromys. The majority of individuals were obtained from Agricultural settings, followed by villages (both inside and outside of homes) with few individuals trapped in the forests. More rodents were trapped in the dry season, than the wet. 20 individuals were positive for <em>Lassa mammarenavirus</em> antibodies.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/species-network-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This produces a species graph which highlights the clustering of <em>Mus musculus</em> and <em>Mastomys natalensis</em> individuals. The majority of individuals do not have ties to any other individuals.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/location-network-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph highlights the locations of the villages from where rodents were trapped. The urban village was Lambayama and here rodents were trapped at greater rates in close proximity to others.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/landuse-network-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The largest component of the network are from rodents trapped in agricultural settings, with smaller components from villages. The largest component from the forest is 3 individuals.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/serostatus-network-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally this graph shows the ties between individuals and their serostatus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Network descriptives</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>rodent_net_descriptives <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"nodes"</span> <span class="ot">=</span> <span class="fu">length</span>(rodent_net <span class="sc">%v%</span> <span class="st">"vertex.names"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"mean_degree"</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">degree</span>(rodent_net, <span class="at">gmode =</span> <span class="st">"graph"</span>)),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"sd_degree"</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">degree</span>(rodent_net, <span class="at">gmode =</span> <span class="st">"graph"</span>)),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"degree_table"</span> <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">degree</span>(rodent_net, <span class="at">gmode =</span> <span class="st">"graph"</span>)),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"triad_table"</span> <span class="ot">=</span> <span class="fu">triad.census</span>(rodent_net, <span class="at">mode =</span> <span class="st">"graph"</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"density"</span> <span class="ot">=</span> <span class="fu">graph.density</span>(<span class="fu">asIgraph</span>(rodent_net)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The mean degree of the graph is 5.44, with a standard deviation of 5.42. The distribution of degrees of each node is shown below, compared to a random graph of the same structure. The density of the network, the proportion of all possible ties observed is 0.013.</p>
</section>
<section id="comparison-to-random-graph" class="level2">
<h2 class="anchored" data-anchor-id="comparison-to-random-graph">Comparison to random graph</h2>
<p>We can construct a random graph with the same number of nodes and tie density to investigate the distribution of degree in the rodent data compared to a random network of similar characteristics.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This shows that more isolated nodes are present than would be expected with a longer right tail of higher degree nodes.</p>
<p>Comparing dyadwise and edgewise shared partner distributions can highlight the clustering in the rodent network.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating the predictor and response matrix.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Maximizing the pseudolikelihood.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished MPLE.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Stopping at the initial estimate.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating log-likelihood at the estimate. 
Starting maximum pseudolikelihood estimation (MPLE):
Evaluating the predictor and response matrix.
Maximizing the pseudolikelihood.
Finished MPLE.
Stopping at the initial estimate.
Evaluating log-likelihood at the estimate. </code></pre>
</div>
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/rodent-clustering-dsp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/rodent-esp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The observed rodent network has more network members with multiple DSP and ESP compared with the random network. The clustering can also be seen by looking at the mixing matrices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mixingmatrix</span>(rodent_net, <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Crocidura spp Lophuromys sikapusi Mastomys natalensis
Crocidura spp                  50                  54                  34
Lophuromys sikapusi            54                  30                  14
Mastomys natalensis            34                  14                  83
Mus minutoides                 31                  26                  12
Mus musculus                   20                   0                   3
Other                          14                  12                  11
Praomys spp                    81                  58                  23
Rattus rattus                  21                   1                  50
                    Mus minutoides Mus musculus Other Praomys spp Rattus rattus
Crocidura spp                   31           20    14          81            21
Lophuromys sikapusi             26            0    12          58             1
Mastomys natalensis             12            3    11          23            50
Mus minutoides                  13            0     2          55             4
Mus musculus                     0          204     0           0             5
Other                            2            0     7          25             5
Praomys spp                     55            0    25         134            14
Rattus rattus                    4            5     5          14            24</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note:  Marginal totals can be misleading for undirected mixing matrices.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mixingmatrix</span>(rodent_net, <span class="st">"Village_loc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Rural Urban
Rural   861     0
Urban     0   259</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note:  Marginal totals can be misleading for undirected mixing matrices.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mixingmatrix</span>(rodent_net, <span class="st">"Landuse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Agriculture Forest Village
Agriculture         678      0      17
Forest                0     64       0
Village              17      0     361</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note:  Marginal totals can be misleading for undirected mixing matrices.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mixingmatrix</span>(rodent_net, <span class="st">"Serostatus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Negative Positive
Negative     1072       46
Positive       46        2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note:  Marginal totals can be misleading for undirected mixing matrices.</code></pre>
</div>
</div>
</section>
<section id="effect-of-node-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="effect-of-node-characteristics">Effect of node characteristics</h2>
<p>We can investigate the effect of node characteristics on degree. Of primary interest is the effect of species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> rodent_net <span class="sc">%v%</span> <span class="st">"Species"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>deg <span class="ot">&lt;-</span> <span class="fu">degree</span>(rodent_net)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Species =</span> species,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">Degree =</span> deg) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Degree =</span> <span class="fu">mean</span>(Degree)) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>Degree) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> <span class="fu">fct_inorder</span>(Species)) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Degree)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean degree by species"</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rodent_networks_files/figure-html/node-characteristics-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The species with the highest mean degree is Mus.</p>
</section>
<section id="building-model" class="level2">
<h2 class="anchored" data-anchor-id="building-model">Building model</h2>
<p>We can build a model by iteratively adding further complexity to address the following hypothesis.</p>
<ol type="1">
<li>There is an association between species and the likelihood of forming ties. This probability will vary by the species involved in the ties.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"modified_functions.R"</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(null_random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = random_net ~ edges)

Maximum Likelihood Results:

      Estimate Std. Error MCMC %   Wald    OR Lower Upper Pr(&gt;|z|)    
edges -4.35928    0.03078      0 -141.6 0.013 0.012 0.014   &lt;1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:  11472  on 84665  degrees of freedom
 
AIC: 11474  BIC: 11483  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>null_rodent <span class="ot">&lt;-</span> <span class="fu">ergm</span>(rodent_net <span class="sc">~</span> edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating the predictor and response matrix.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Maximizing the pseudolikelihood.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished MPLE.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Stopping at the initial estimate.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating log-likelihood at the estimate. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(null_rodent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = rodent_net ~ edges)

Maximum Likelihood Results:

      Estimate Std. Error MCMC %   Wald    OR Lower Upper Pr(&gt;|z|)    
edges -4.31207    0.03008      0 -143.4 0.013 0.013 0.014   &lt;1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:  11914  on 84665  degrees of freedom
 
AIC: 11916  BIC: 11925  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>main_effects_1 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(rodent_net <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">nodefactor</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):
Evaluating the predictor and response matrix.
Maximizing the pseudolikelihood.
Finished MPLE.
Stopping at the initial estimate.
Evaluating log-likelihood at the estimate. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(main_effects_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = rodent_net ~ edges + nodefactor("Species", levels = c("Crocidura spp", 
    "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", 
    "Mus musculus", "Rattus rattus", "Mus minutoides")))

Maximum Likelihood Results:

                                       Estimate Std. Error MCMC %    Wald    OR
edges                                   -5.5424     0.2186      0 -25.357 0.004
nodefactor.Species.Crocidura spp         0.3710     0.1226      0   3.027 1.449
nodefactor.Species.Mastomys natalensis   0.3461     0.1241      0   2.788 1.414
nodefactor.Species.Praomys spp           0.9712     0.1189      0   8.169 2.641
nodefactor.Species.Lophuromys sikapusi   0.5524     0.1292      0   4.276 1.737
nodefactor.Species.Mus musculus          1.3031     0.1207      0  10.797 3.681
nodefactor.Species.Rattus rattus         0.2761     0.1379      0   2.002 1.318
nodefactor.Species.Mus minutoides        0.4128     0.1366      0   3.021 1.511
                                       Lower Upper Pr(&gt;|z|)    
edges                                  0.003 0.006  &lt; 1e-04 ***
nodefactor.Species.Crocidura spp       1.140 1.843  0.00247 ** 
nodefactor.Species.Mastomys natalensis 1.108 1.803  0.00530 ** 
nodefactor.Species.Praomys spp         2.092 3.334  &lt; 1e-04 ***
nodefactor.Species.Lophuromys sikapusi 1.349 2.238  &lt; 1e-04 ***
nodefactor.Species.Mus musculus        2.905 4.663  &lt; 1e-04 ***
nodefactor.Species.Rattus rattus       1.006 1.727  0.04525 *  
nodefactor.Species.Mus minutoides      1.156 1.975  0.00252 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:  11582  on 84658  degrees of freedom
 
AIC: 11598  BIC: 11673  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>edges_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(main_effects_1<span class="sc">$</span>coefficients[<span class="st">"edges"</span>]), <span class="dv">3</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mus_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(main_effects_1<span class="sc">$</span>coefficients[<span class="st">"nodefactor.Species.Mus musculus"</span>]), <span class="dv">3</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>mas_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(main_effects_1<span class="sc">$</span>coefficients[<span class="st">"nodefactor.Species.Mastomys natalensis"</span>]), <span class="dv">3</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>simple_species_1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">2</span>)), <span class="dv">2</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>simple_species_2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">1</span>)), <span class="dv">3</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>simple_species_3 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">2</span>)), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first model is the random model, which matches the null rodent model for the Odds of a tie forming:</p>
<ol type="1">
<li>Compared to the reference species of other species, all species have a higher odds of forming a tie. <em>Mus musculus</em> being the most likely, followed by <em>Praomys spp</em> and <em>Mastomys natalensis</em>.</li>
</ol>
<section id="predicting-ties" class="level3">
<h3 class="anchored" data-anchor-id="predicting-ties">Predicting ties</h3>
<p>The probability of ties between network members can be calculated.</p>
<ol type="1">
<li>Species model</li>
</ol>
<!-- -->
<ol type="i">
<li>A <em>Mus musculus</em> rodent and another <em>Mus musculus</em> = <span class="math display">\[\text{logistic}(-5.542 * 1 + 1.303 * 2) = 0.05\]</span></li>
<li>A <em>Mus musculus</em> rodent and a <em>Mastomys natalensis</em> = <span class="math display">\[\text{logistic}(-5.542 * 1 + 1.303 * 1 + 0.346 * 1) = 0.02\]</span></li>
<li>A <em>Mastomys natalensis</em> rodent and another <em>Mastomys natalensis</em> = <span class="math display">\[\text{logistic}(-5.542 * 1 + 0.346 * 2) = 0.008\]</span></li>
</ol>
<!-- -->
<p>These models are overly simplistic as they do not count for homophily which is important in this context.</p>
</section>
</section>
<section id="adding-homophily" class="level2">
<h2 class="anchored" data-anchor-id="adding-homophily">Adding homophily</h2>
<p>Continuing to assume dyadic independence we can add differential homophily terms to the models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>homophily_1 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(rodent_net <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">nodefactor</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>)) <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating the predictor and response matrix.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Maximizing the pseudolikelihood.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished MPLE.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Stopping at the initial estimate.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating log-likelihood at the estimate. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(homophily_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = rodent_net ~ edges + nodefactor("Species", levels = c("Crocidura spp", 
    "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", 
    "Mus musculus", "Rattus rattus", "Mus minutoides")) + nodematch("Species", 
    levels = c("Crocidura spp", "Mastomys natalensis", "Praomys spp", 
        "Lophuromys sikapusi", "Mus musculus", "Rattus rattus", 
        "Mus minutoides"), diff = TRUE))

Maximum Likelihood Results:

                                       Estimate Std. Error MCMC %    Wald
edges                                  -5.05845    0.21809      0 -23.194
nodefactor.Species.Crocidura spp        0.31160    0.13317      0   2.340
nodefactor.Species.Mastomys natalensis -0.29088    0.14166      0  -2.053
nodefactor.Species.Praomys spp          0.51886    0.13316      0   3.897
nodefactor.Species.Lophuromys sikapusi  0.38403    0.13936      0   2.756
nodefactor.Species.Mus musculus        -1.45595    0.22073      0  -6.596
nodefactor.Species.Rattus rattus       -0.04077    0.15222      0  -0.268
nodefactor.Species.Mus minutoides       0.33639    0.14476      0   2.324
nodematch.Species.Crocidura spp         0.22966    0.19831      0   1.158
nodematch.Species.Mastomys natalensis   2.16102    0.20538      0  10.522
nodematch.Species.Praomys spp           1.24814    0.16410      0   7.606
nodematch.Species.Lophuromys sikapusi   0.87157    0.24788      0   3.516
nodematch.Species.Mus musculus          6.86523    0.38925      0  17.637
nodematch.Species.Rattus rattus         1.79741    0.29258      0   6.143
nodematch.Species.Mus minutoides        0.58415    0.33474      0   1.745
                                            OR   Lower    Upper Pr(&gt;|z|)    
edges                                    0.006   0.004    0.010  &lt; 1e-04 ***
nodefactor.Species.Crocidura spp         1.366   1.052    1.773 0.019291 *  
nodefactor.Species.Mastomys natalensis   0.748   0.566    0.987 0.040037 *  
nodefactor.Species.Praomys spp           1.680   1.294    2.181  &lt; 1e-04 ***
nodefactor.Species.Lophuromys sikapusi   1.468   1.117    1.929 0.005859 ** 
nodefactor.Species.Mus musculus          0.233   0.151    0.359  &lt; 1e-04 ***
nodefactor.Species.Rattus rattus         0.960   0.712    1.294 0.788857    
nodefactor.Species.Mus minutoides        1.400   1.054    1.859 0.020138 *  
nodematch.Species.Crocidura spp          1.258   0.853    1.856 0.246844    
nodematch.Species.Mastomys natalensis    8.680   5.804   12.982  &lt; 1e-04 ***
nodematch.Species.Praomys spp            3.484   2.526    4.806  &lt; 1e-04 ***
nodematch.Species.Lophuromys sikapusi    2.391   1.471    3.886 0.000438 ***
nodematch.Species.Mus musculus         958.364 446.882 2055.263  &lt; 1e-04 ***
nodematch.Species.Rattus rattus          6.034   3.401   10.707  &lt; 1e-04 ***
nodematch.Species.Mus minutoides         1.793   0.931    3.456 0.080969 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:  10402  on 84651  degrees of freedom
 
AIC: 10432  BIC: 10572  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>edges_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(homophily_1<span class="sc">$</span>coefficients[<span class="st">"edges"</span>]), <span class="dv">3</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>mus_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(homophily_1<span class="sc">$</span>coefficients[<span class="st">"nodefactor.Species.Mus musculus"</span>]), <span class="dv">3</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>mus_homo_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(homophily_1<span class="sc">$</span>coefficients[<span class="st">"nodematch.Species.Mus musculus"</span>]), <span class="dv">3</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>mas_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(homophily_1<span class="sc">$</span>coefficients[<span class="st">"nodefactor.Species.Mastomys natalensis"</span>]), <span class="dv">3</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>mas_homo_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(homophily_1<span class="sc">$</span>coefficients[<span class="st">"nodematch.Species.Mastomys natalensis"</span>]), <span class="dv">3</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>homophily_species_4 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> mus_homo_coeff <span class="sc">*</span> <span class="dv">1</span>)), <span class="dv">3</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>homophily_species_5 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">1</span>)), <span class="dv">3</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>homophily_species_6 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> mas_homo_coeff <span class="sc">*</span> <span class="dv">1</span>)), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Compared to the reference species of other species, all species except <em>Mus musculus</em> have a higher odds of forming a tie when taking into account homophily. The values for homophily suggest that <em>Mus musculus</em>, <em>Mastomys natalensis</em> and <em>Rattus rattus</em> are the most likely to form ties amongst individuals of the same species.</li>
</ol>
<section id="predicting-ties-1" class="level3">
<h3 class="anchored" data-anchor-id="predicting-ties-1">Predicting ties</h3>
<p>The probability of ties between network members can be calculated for the differential homophily models.</p>
<ol type="1">
<li>Species model</li>
</ol>
<!-- -->
<ol start="4" type="i">
<li>A <em>Mus musculus</em> rodent and another <em>Mus musculus</em> = <span class="math display">\[\text{logistic}(-5.058 * 1 + -1.456 * 2 + 6.865 * 1) = 0.249 \]</span></li>
<li>A <em>Mus musculus</em> rodent and a <em>Mastomys natalensis</em> = <span class="math display">\[\text{logistic}((-5.058 * 1 + -1.456 * 1 + -0.291 * 1) = 0.001\]</span></li>
<li>A <em>Mastomys natalensis</em> rodent and another <em>Mastomys natalensis</em> = <span class="math display">\[\text{logistic}(-5.058 * 1 + -0.291 * 2 + 2.161 * 1) = 0.03\]</span></li>
</ol>
<!-- -->
</section>
</section>
<section id="additional-terms" class="level2">
<h2 class="anchored" data-anchor-id="additional-terms">Additional terms</h2>
<p>Landuse type, village location (Urban/Rural) and Season are likely important components of these models. We can add Landuse type and village location in as <code>nodematch</code> terms as there is expected to be clustering of species or homophily within these locations. Season may or may not be a clustering term as it may be that all species respond to changing seasons in the same way. For the first model season will be added in as <code>nodefactor</code>, and for the second <code>nodematch</code>. The model with the lowest AIC will then be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>add_terms_species_1 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(rodent_net <span class="sc">~</span> edges <span class="sc">+</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodefactor</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodefactor</span>(<span class="st">"Season"</span>, <span class="at">levels =</span> <span class="st">"Dry"</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Village_loc"</span>, <span class="at">levels =</span>  <span class="st">"Rural"</span>, <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Landuse"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Village"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating the predictor and response matrix.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Maximizing the pseudolikelihood.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished MPLE.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Stopping at the initial estimate.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Evaluating log-likelihood at the estimate. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(add_terms_species_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = rodent_net ~ edges + nodefactor("Species", levels = c("Crocidura spp", 
    "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", 
    "Mus musculus", "Rattus rattus", "Mus minutoides")) + nodematch("Species", 
    levels = c("Crocidura spp", "Mastomys natalensis", "Praomys spp", 
        "Lophuromys sikapusi", "Mus musculus", "Rattus rattus", 
        "Mus minutoides"), diff = TRUE) + nodefactor("Season", 
    levels = "Dry") + nodematch("Village_loc", levels = "Rural", 
    diff = TRUE) + nodematch("Landuse", levels = c("Agriculture", 
    "Village"), diff = TRUE))

Maximum Likelihood Results:

                                       Estimate Std. Error MCMC %    Wald
edges                                  -7.53108    0.31387      0 -23.994
nodefactor.Species.Crocidura spp        0.06579    0.13481      0   0.488
nodefactor.Species.Mastomys natalensis -0.63890    0.14332      0  -4.458
nodefactor.Species.Praomys spp          0.27069    0.13443      0   2.014
nodefactor.Species.Lophuromys sikapusi -0.04261    0.14103      0  -0.302
nodefactor.Species.Mus musculus        -0.45447    0.30276      0  -1.501
nodefactor.Species.Rattus rattus       -0.04301    0.16322      0  -0.264
nodefactor.Species.Mus minutoides      -0.03249    0.14703      0  -0.221
nodematch.Species.Crocidura spp         0.22907    0.19940      0   1.149
nodematch.Species.Mastomys natalensis   2.10394    0.20783      0  10.124
nodematch.Species.Praomys spp           1.23427    0.16594      0   7.438
nodematch.Species.Lophuromys sikapusi   0.76916    0.24895      0   3.090
nodematch.Species.Mus musculus          4.19349    0.44035      0   9.523
nodematch.Species.Rattus rattus         0.38073    0.29946      0   1.271
nodematch.Species.Mus minutoides        0.38331    0.33605      0   1.141
nodefactor.Season.Dry                   0.14211    0.05086      0   2.794
nodematch.Village_loc.Rural             1.19771    0.20051      0   5.973
nodematch.Landuse.Agriculture           2.12799    0.12240      0  17.386
nodematch.Landuse.Village               3.04914    0.15161      0  20.112
                                           OR  Lower   Upper Pr(&gt;|z|)    
edges                                   0.001  0.000   0.001  &lt; 1e-04 ***
nodefactor.Species.Crocidura spp        1.068  0.820   1.391  0.62554    
nodefactor.Species.Mastomys natalensis  0.528  0.399   0.699  &lt; 1e-04 ***
nodefactor.Species.Praomys spp          1.311  1.007   1.706  0.04405 *  
nodefactor.Species.Lophuromys sikapusi  0.958  0.727   1.263  0.76254    
nodefactor.Species.Mus musculus         0.635  0.351   1.149  0.13333    
nodefactor.Species.Rattus rattus        0.958  0.696   1.319  0.79215    
nodefactor.Species.Mus minutoides       0.968  0.726   1.291  0.82512    
nodematch.Species.Crocidura spp         1.257  0.851   1.859  0.25064    
nodematch.Species.Mastomys natalensis   8.198  5.455  12.321  &lt; 1e-04 ***
nodematch.Species.Praomys spp           3.436  2.482   4.757  &lt; 1e-04 ***
nodematch.Species.Lophuromys sikapusi   2.158  1.325   3.515  0.00200 ** 
nodematch.Species.Mus musculus         66.254 27.950 157.051  &lt; 1e-04 ***
nodematch.Species.Rattus rattus         1.463  0.814   2.632  0.20358    
nodematch.Species.Mus minutoides        1.467  0.759   2.835  0.25402    
nodefactor.Season.Dry                   1.153  1.043   1.274  0.00521 ** 
nodematch.Village_loc.Rural             3.313  2.236   4.907  &lt; 1e-04 ***
nodematch.Landuse.Agriculture           8.398  6.607  10.675  &lt; 1e-04 ***
nodematch.Landuse.Village              21.097 15.674  28.398  &lt; 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:   9650  on 84647  degrees of freedom
 
AIC: 9688  BIC: 9866  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>add_terms_species_2 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(rodent_net <span class="sc">~</span> edges <span class="sc">+</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodefactor</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Season"</span>, <span class="at">levels =</span> <span class="st">"Dry"</span>, <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Village_loc"</span>, <span class="at">levels =</span>  <span class="st">"Rural"</span>, <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Landuse"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Village"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):
Evaluating the predictor and response matrix.
Maximizing the pseudolikelihood.
Finished MPLE.
Stopping at the initial estimate.
Evaluating log-likelihood at the estimate. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(add_terms_species_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = rodent_net ~ edges + nodefactor("Species", levels = c("Crocidura spp", 
    "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", 
    "Mus musculus", "Rattus rattus", "Mus minutoides")) + nodematch("Species", 
    levels = c("Crocidura spp", "Mastomys natalensis", "Praomys spp", 
        "Lophuromys sikapusi", "Mus musculus", "Rattus rattus", 
        "Mus minutoides"), diff = TRUE) + nodematch("Season", 
    levels = "Dry", diff = TRUE) + nodematch("Village_loc", levels = "Rural", 
    diff = TRUE) + nodematch("Landuse", levels = c("Agriculture", 
    "Village"), diff = TRUE))

Maximum Likelihood Results:

                                        Estimate Std. Error MCMC %    Wald
edges                                  -7.955912   0.311740      0 -25.521
nodefactor.Species.Crocidura spp        0.207360   0.135013      0   1.536
nodefactor.Species.Mastomys natalensis -0.621936   0.143619      0  -4.330
nodefactor.Species.Praomys spp          0.288247   0.134819      0   2.138
nodefactor.Species.Lophuromys sikapusi -0.005219   0.141636      0  -0.037
nodefactor.Species.Mus musculus        -0.413918   0.302756      0  -1.367
nodefactor.Species.Rattus rattus       -0.015404   0.164081      0  -0.094
nodefactor.Species.Mus minutoides       0.064586   0.147470      0   0.438
nodematch.Species.Crocidura spp         0.230529   0.200183      0   1.152
nodematch.Species.Mastomys natalensis   2.138404   0.208399      0  10.261
nodematch.Species.Praomys spp           1.257086   0.166826      0   7.535
nodematch.Species.Lophuromys sikapusi   0.743083   0.249952      0   2.973
nodematch.Species.Mus musculus          4.445242   0.441111      0  10.077
nodematch.Species.Rattus rattus         0.355359   0.301340      0   1.179
nodematch.Species.Mus minutoides        0.389452   0.337379      0   1.154
nodematch.Season.Dry                    1.283369   0.077595      0  16.539
nodematch.Village_loc.Rural             0.859475   0.201389      0   4.268
nodematch.Landuse.Agriculture           2.138813   0.122787      0  17.419
nodematch.Landuse.Village               3.082453   0.152163      0  20.258
                                           OR  Lower   Upper Pr(&gt;|z|)    
edges                                   0.000  0.000   0.001  &lt; 1e-04 ***
nodefactor.Species.Crocidura spp        1.230  0.944   1.603  0.12457    
nodefactor.Species.Mastomys natalensis  0.537  0.405   0.711  &lt; 1e-04 ***
nodefactor.Species.Praomys spp          1.334  1.024   1.738  0.03251 *  
nodefactor.Species.Lophuromys sikapusi  0.995  0.754   1.313  0.97060    
nodefactor.Species.Mus musculus         0.661  0.365   1.197  0.17157    
nodefactor.Species.Rattus rattus        0.985  0.714   1.358  0.92520    
nodefactor.Species.Mus minutoides       1.067  0.799   1.424  0.66142    
nodematch.Species.Crocidura spp         1.259  0.851   1.864  0.24949    
nodematch.Species.Mastomys natalensis   8.486  5.640  12.767  &lt; 1e-04 ***
nodematch.Species.Praomys spp           3.515  2.535   4.875  &lt; 1e-04 ***
nodematch.Species.Lophuromys sikapusi   2.102  1.288   3.431  0.00295 ** 
nodematch.Species.Mus musculus         85.220 35.897 202.314  &lt; 1e-04 ***
nodematch.Species.Rattus rattus         1.427  0.790   2.575  0.23829    
nodematch.Species.Mus minutoides        1.476  0.762   2.860  0.24836    
nodematch.Season.Dry                    3.609  3.100   4.202  &lt; 1e-04 ***
nodematch.Village_loc.Rural             2.362  1.592   3.505  &lt; 1e-04 ***
nodematch.Landuse.Agriculture           8.489  6.674  10.799  &lt; 1e-04 ***
nodematch.Landuse.Village              21.812 16.187  29.391  &lt; 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:   9340  on 84647  degrees of freedom
 
AIC: 9378  BIC: 9556  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>add_terms_species_3 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(rodent_net <span class="sc">~</span> edges <span class="sc">+</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodefactor</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Species"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Crocidura spp"</span>, <span class="st">"Mastomys natalensis"</span>, <span class="st">"Praomys spp"</span>, <span class="st">"Lophuromys sikapusi"</span>, <span class="st">"Mus musculus"</span>, <span class="st">"Rattus rattus"</span>, <span class="st">"Mus minutoides"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Season"</span>, <span class="at">levels =</span> <span class="st">"Dry"</span>, <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Village_loc"</span>, <span class="at">levels =</span>  <span class="st">"Rural"</span>, <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nodematch</span>(<span class="st">"Landuse"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Village"</span>), <span class="at">diff =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">isolates</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting maximum pseudolikelihood estimation (MPLE):
Evaluating the predictor and response matrix.
Maximizing the pseudolikelihood.
Finished MPLE.
Starting Monte Carlo maximum likelihood estimation (MCMLE):
Iteration 1 of at most 60:
Optimizing with step length 0.4407.
The log-likelihood improved by 3.1266.
Estimating equations are not within tolerance region.
Iteration 2 of at most 60:
Optimizing with step length 0.6926.
The log-likelihood improved by 2.1698.
Estimating equations are not within tolerance region.
Iteration 3 of at most 60:
Optimizing with step length 0.9346.
The log-likelihood improved by 1.9666.
Estimating equations are not within tolerance region.
Iteration 4 of at most 60:
Optimizing with step length 0.7735.
The log-likelihood improved by 2.2736.
Estimating equations are not within tolerance region.
Iteration 5 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 1.7933.
Estimating equations are not within tolerance region.
Iteration 6 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.1691.
Estimating equations are not within tolerance region.
Iteration 7 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.2034.
Estimating equations are not within tolerance region.
Estimating equations did not move closer to tolerance region more than 1 time(s) in 4 steps; increasing sample size.
Iteration 8 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.0468.
Convergence test p-value: 1.0000. Not converged with 99% confidence; increasing sample size.
Iteration 9 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.1088.
Estimating equations are not within tolerance region.
Iteration 10 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.1179.
Estimating equations are not within tolerance region.
Estimating equations did not move closer to tolerance region more than 1 time(s) in 4 steps; increasing sample size.
Iteration 11 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.0612.
Convergence test p-value: 0.9992. Not converged with 99% confidence; increasing sample size.
Iteration 12 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.0601.
Convergence test p-value: 0.9776. Not converged with 99% confidence; increasing sample size.
Iteration 13 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.0114.
Convergence test p-value: 0.1284. Not converged with 99% confidence; increasing sample size.
Iteration 14 of at most 60:
Optimizing with step length 1.0000.
The log-likelihood improved by 0.0106.
Convergence test p-value: 0.0090. Converged with 99% confidence.
Finished MCMLE.
Evaluating log-likelihood at the estimate. Fitting the dyad-independent submodel...
Bridging between the dyad-independent submodel and the full model...
Setting up bridge sampling...
Using 16 bridges: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 .
Bridging finished.
This model was fit using MCMC.  To examine model diagnostics and check
for degeneracy, use the mcmc.diagnostics() function.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.ergm.david</span>(add_terms_species_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = rodent_net ~ edges + nodefactor("Species", levels = c("Crocidura spp", 
    "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", 
    "Mus musculus", "Rattus rattus", "Mus minutoides")) + nodematch("Species", 
    levels = c("Crocidura spp", "Mastomys natalensis", "Praomys spp", 
        "Lophuromys sikapusi", "Mus musculus", "Rattus rattus", 
        "Mus minutoides"), diff = TRUE) + nodematch("Season", 
    levels = "Dry", diff = TRUE) + nodematch("Village_loc", levels = "Rural", 
    diff = TRUE) + nodematch("Landuse", levels = c("Agriculture", 
    "Village"), diff = TRUE) + isolates())

Monte Carlo Maximum Likelihood Results:

                                       Estimate Std. Error MCMC %    Wald
edges                                  -7.88464    0.33586      0 -23.476
nodefactor.Species.Crocidura spp        0.19926    0.13547      0   1.471
nodefactor.Species.Mastomys natalensis -0.62852    0.14148      0  -4.442
nodefactor.Species.Praomys spp          0.27793    0.13598      0   2.044
nodefactor.Species.Lophuromys sikapusi -0.01499    0.14221      0  -0.105
nodefactor.Species.Mus musculus        -0.45319    0.30762      0  -1.473
nodefactor.Species.Rattus rattus       -0.02688    0.16584      0  -0.162
nodefactor.Species.Mus minutoides       0.05508    0.14769      0   0.373
nodematch.Species.Crocidura spp         0.22679    0.20390      0   1.112
nodematch.Species.Mastomys natalensis   2.13216    0.21049      0  10.129
nodematch.Species.Praomys spp           1.25590    0.17155      0   7.321
nodematch.Species.Lophuromys sikapusi   0.73982    0.24899      0   2.971
nodematch.Species.Mus musculus          4.46616    0.43685      0  10.224
nodematch.Species.Rattus rattus         0.36796    0.30132      0   1.221
nodematch.Species.Mus minutoides        0.39022    0.33961      0   1.149
nodematch.Season.Dry                    1.27008    0.08081      0  15.716
nodematch.Village_loc.Rural             0.83775    0.20521      0   4.082
nodematch.Landuse.Agriculture           2.12291    0.12591      0  16.860
nodematch.Landuse.Village               3.06897    0.15310      0  20.045
isolates                                0.14085    0.25684      0   0.548
                                           OR  Lower   Upper Pr(&gt;|z|)    
edges                                   0.000  0.000   0.001  &lt; 1e-04 ***
nodefactor.Species.Crocidura spp        1.220  0.936   1.592  0.14134    
nodefactor.Species.Mastomys natalensis  0.533  0.404   0.704  &lt; 1e-04 ***
nodefactor.Species.Praomys spp          1.320  1.011   1.724  0.04096 *  
nodefactor.Species.Lophuromys sikapusi  0.985  0.745   1.302  0.91605    
nodefactor.Species.Mus musculus         0.636  0.348   1.162  0.14069    
nodefactor.Species.Rattus rattus        0.973  0.703   1.347  0.87125    
nodefactor.Species.Mus minutoides       1.057  0.791   1.411  0.70918    
nodematch.Species.Crocidura spp         1.255  0.841   1.871  0.26602    
nodematch.Species.Mastomys natalensis   8.433  5.582  12.740  &lt; 1e-04 ***
nodematch.Species.Praomys spp           3.511  2.508   4.914  &lt; 1e-04 ***
nodematch.Species.Lophuromys sikapusi   2.096  1.286   3.414  0.00297 ** 
nodematch.Species.Mus musculus         87.022 36.964 204.870  &lt; 1e-04 ***
nodematch.Species.Rattus rattus         1.445  0.800   2.608  0.22202    
nodematch.Species.Mus minutoides        1.477  0.759   2.874  0.25055    
nodematch.Season.Dry                    3.561  3.039   4.172  &lt; 1e-04 ***
nodematch.Village_loc.Rural             2.311  1.546   3.455  &lt; 1e-04 ***
nodematch.Landuse.Agriculture           8.355  6.528  10.694  &lt; 1e-04 ***
nodematch.Landuse.Village              21.520 15.941  29.051  &lt; 1e-04 ***
isolates                                1.151  0.696   1.905  0.58341    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 117372  on 84666  degrees of freedom
 Residual Deviance:   9340  on 84646  degrees of freedom
 
AIC: 9380  BIC: 9567  (Smaller is better. MC Std. Err. = 0.01513)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>AIC <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">"add_terms_species_1"</span>, <span class="st">"add_terms_species_2"</span>, <span class="st">"add_terms_species_3"</span>),</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(add_terms_species_1), <span class="fu">AIC</span>(add_terms_species_2), <span class="fu">AIC</span>(add_terms_species_3)))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>AIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 2
  model                 AIC
  &lt;chr&gt;               &lt;dbl&gt;
1 add_terms_species_1 9688.
2 add_terms_species_2 9378.
3 add_terms_species_3 9380.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> AIC <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AIC) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(model)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">=</span> <span class="fu">get</span>(best_model[[<span class="dv">1</span>]])</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>edges_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"edges"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>mus_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodefactor.Species.Mus musculus"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>mus_homo_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodematch.Species.Mus musculus"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>mas_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodefactor.Species.Mastomys natalensis"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>mas_homo_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodematch.Species.Mastomys natalensis"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>rural_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodematch.Village_loc.Rural"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>dry_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodematch.Season.Dry"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>village_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodematch.Landuse.Village"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>agri_coeff <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unname</span>(best_model<span class="sc">$</span>coefficients[<span class="st">"nodematch.Landuse.Agriculture"</span>]), <span class="dv">3</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>homophily_species_7 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> mus_homo_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> dry_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> village_coeff <span class="sc">*</span> <span class="dv">1</span>))</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>homophily_species_8 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> dry_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> village_coeff <span class="sc">*</span> <span class="dv">1</span>))</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>homophily_species_9 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mus_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> rural_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> dry_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> village_coeff <span class="sc">*</span> <span class="dv">1</span>))</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>homophily_species_10 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> mas_homo_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> dry_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> village_coeff <span class="sc">*</span> <span class="dv">1</span>))</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>homophily_species_11 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> mas_homo_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> rural_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> dry_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> village_coeff <span class="sc">*</span> <span class="dv">1</span>))</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>homophily_species_12 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="at">q =</span> (edges_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> mas_coeff <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> mas_homo_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> rural_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> dry_coeff <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> agri_coeff <span class="sc">*</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For both of these more complex models the inclusion of the additional terms as differential homophily terms improves model fit. We can repeat the above equations to calculate the probability of a tie.</p>
<section id="predicting-ties-2" class="level3">
<h3 class="anchored" data-anchor-id="predicting-ties-2">Predicting ties</h3>
<p>The probability of ties between network members can be calculated for the differential homophily model with the lowest AIC.</p>
<ol type="1">
<li>Species model</li>
</ol>
<!-- -->
<ol start="7" type="i">
<li>A <em>Mus musculus</em> rodent and another <em>Mus musculus</em> in an urban setting, during the dry season, within the village = <span class="math display">\[\text{logistic}(-7.956 * 1 + -0.414 * 2 + 4.445 * 1 + 1.283 * 1 + 3.082 * 1) = 0.5064996\]</span></li>
<li>A <em>Mus musculus</em> rodent and a <em>Mastomys natalensis</em> in an urban setting, during the dry season, within the village = <span class="math display">\[\text{logistic}(-7.956 * 1 + -0.414 * 1 + -0.622 * 1 + 1.283 * 1 + 3.082 * 1) = 0.0096893\]</span></li>
<li>A <em>Mus musculus</em> rodent and a <em>Mastomys natalensis</em> in a rural setting, during the dry season, within the village = <span class="math display">\[\text{logistic}(-7.956 * 1 + -0.414 * 1 + -0.622 * 1 + 0.859 * 1 + 1.283 * 1 + 3.082 * 1) = 0.0225767\]</span></li>
<li>A <em>Mastomys natalensis</em> rodent and another <em>Mastomys natalensis</em> in an urban setting, during the dry season, within the village = <span class="math display">\[\text{logistic}(-7.956 * 1 + -0.622 * 2 + 2.138 * 1 + 1.283 * 1 + 3.082 * 1) = 0.0631506\]</span></li>
<li>A <em>Mastomys natalensis</em> rodent and another <em>Mastomys natalensis</em> in a rural setting, during the dry season, within the village = <span class="math display">\[\text{logistic}(-7.956 * 1 + -0.622 * 2 + 2.138 * 1 + 0.859 * 1 + 1.283 * 1 + 3.082 * 1) = 0.137288\]</span></li>
<li>A <em>Mastomys natalensis</em> rodent and another <em>Mastomys natalensis</em> in a rural setting, during the dry season, within agricultural land = <span class="math display">\[\text{logistic}(-7.956 * 1 + -0.622 * 2 + 2.138 * 1 + 0.859 * 1 + 1.283 * 1 + 2.139 * 1) = 0.0583596\]</span></li>
</ol>
<!-- -->
<p>These probabilities show that two <em>Mus musculus</em> in urban village settings have the greatest odds of coming into contact with another individual of the same species, this is much greater than the rates of contacts between a <em>Mus musculus</em> and a <em>Mastomys natalensis</em> as well as the contact rates between two <em>Mastomys natalensis</em> all other things being equal. We also see that two <em>Mastomys natalensis</em> have greater odds of contact within the rural villages compared to urban villages, and within the village compared to in agricultural land.</p>
</section>
</section>
<section id="model-fit" class="level2">
<h2 class="anchored" data-anchor-id="model-fit">Model fit</h2>
<p>The models so far assume dyadic independence. We can test the fit of these models through various means. First for the species tie model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First simulate the models</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>null_sim <span class="ot">&lt;-</span> <span class="fu">simulate</span>(null_random, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initializing unconstrained Metropolis-Hastings proposal: 'ergm:MH_TNT'.
Initializing model...
Model initialized.
Starting MCMC iterations to generate 1 network</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>main_1_sim <span class="ot">&lt;-</span> <span class="fu">simulate</span>(main_effects_1, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initializing unconstrained Metropolis-Hastings proposal: 'ergm:MH_TNT'.
Initializing model...
Model initialized.
Starting MCMC iterations to generate 1 network</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>homophily_1_sim <span class="ot">&lt;-</span> <span class="fu">simulate</span>(homophily_1, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initializing unconstrained Metropolis-Hastings proposal: 'ergm:MH_TNT'.
Initializing model...
Model initialized.
Starting MCMC iterations to generate 1 network</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>complex_sim_1 <span class="ot">&lt;-</span> <span class="fu">simulate</span>(add_terms_species_1, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initializing unconstrained Metropolis-Hastings proposal: 'ergm:MH_TNT'.
Initializing model...
Model initialized.
Starting MCMC iterations to generate 1 network</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>complex_sim_2 <span class="ot">&lt;-</span> <span class="fu">simulate</span>(add_terms_species_2, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initializing unconstrained Metropolis-Hastings proposal: 'ergm:MH_TNT'.
Initializing model...
Model initialized.
Starting MCMC iterations to generate 1 network</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>complex_sim_3 <span class="ot">&lt;-</span> <span class="fu">simulate</span>(add_terms_species_3, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initializing unconstrained Metropolis-Hastings proposal: 'ergm:MH_TNT'.
Initializing model...
Model initialized.
Starting MCMC iterations to generate 1 network</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>row_gof <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">summary</span>(rodent_net <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle),</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summary</span>(null_sim <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle),</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summary</span>(main_1_sim <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summary</span>(homophily_1_sim <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle),</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summary</span>(complex_sim_1 <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle),</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summary</span>(complex_sim_2 <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle),</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summary</span>(complex_sim_3 <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">degree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">+</span> triangle))</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">"Observed network"</span>, <span class="st">"Null model"</span>, <span class="st">"Main effects only"</span>, <span class="st">"Homophily only"</span>, <span class="st">"Differential homophily and terms 1"</span>, <span class="st">"Differential homophily and terms 2"</span>, <span class="st">"Differential homophily and isolates"</span>), row_gof,</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">aic =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">AIC</span>(null_random)[<span class="dv">1</span>], <span class="fu">AIC</span>(main_effects_1)[<span class="dv">1</span>], <span class="fu">AIC</span>(homophily_1)[<span class="dv">1</span>], <span class="fu">AIC</span>(add_terms_species_1)[<span class="dv">1</span>], <span class="fu">AIC</span>(add_terms_species_2)[<span class="dv">1</span>],</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">AIC</span>(add_terms_species_3)[<span class="dv">1</span>]),</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">bic =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">BIC</span>(null_random)[<span class="dv">1</span>], <span class="fu">BIC</span>(main_effects_1)[<span class="dv">1</span>], <span class="fu">BIC</span>(homophily_1)[<span class="dv">1</span>], <span class="fu">BIC</span>(add_terms_species_1)[<span class="dv">1</span>], <span class="fu">BIC</span>(add_terms_species_2)[<span class="dv">1</span>],</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">BIC</span>(add_terms_species_3)[<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 x 11
  model     edges degree0 degree1 degree2 degree3 degree4 degree5 trian~1    aic
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 Observed~  1120      29      54      47      42      58      31    3330    NA 
2 Null mod~  1059       0      21      21      51      70      80      24 11474.
3 Main eff~  1063       6      26      44      63      82      50      39 11598.
4 Homophil~  1095       7      21      39      72      56      51     375 10432.
5 Differen~  1128      19      29      35      55      62      49     536  9688.
6 Differen~  1181      32      21      44      48      40      33     459  9378.
7 Differen~  1139      34      33      44      27      49      42     262  9380.
# ... with 1 more variable: bic &lt;dbl&gt;, and abbreviated variable name
#   1: triangle</code></pre>
</div>
</div>
<p>This summarises the simulations from the different models compared to the observed network alongside showing the reducing AIC/BIC as homophily and additional terms are added. These models fail to capture the number of triangles and low degree nodes within the observed network. However, adding dependence terms including GWdegree, GWESP and GWDSP results in a degenerate model.</p>
</section>
<section id="cef" class="level2">
<h2 class="anchored" data-anchor-id="cef">CEF</h2>
<p>This does not work for the complete model. Despite several attempts and leaving for several days.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cefmodel_species &lt;- ergm(rodent_net ~ edges + </span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                            nodefactor("Species", levels = c("Crocidura spp", "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", "Mus musculus", "Rattus rattus", "Mus minutoides")) +</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                            nodematch("Species", levels = c("Crocidura spp", "Mastomys natalensis", "Praomys spp", "Lophuromys sikapusi", "Mus musculus", "Rattus rattus", "Mus minutoides"), diff = TRUE) +</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                            nodematch("Season", levels = "Dry", diff = TRUE) +</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                            nodematch("Village_loc", levels =  "Rural", diff = TRUE) +</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                            nodematch("Landuse", levels = c("Agriculture", "Village"), diff = TRUE) +</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                            gwdegree(cutoff = 5) +</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                            gwesp(cutoff = 5) +</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                            gwdsp(cutoff = 5),</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                          eval.loglik = TRUE,</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                          verbose = TRUE)</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># write_rds(cefmodel_species, here("temp", "cef_species.rds"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>