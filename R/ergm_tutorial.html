<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>ERGM Tutorial</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-10-10"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-10-10"/>
  <meta name="article:author" content="David Simons"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="ERGM Tutorial"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="ERGM Tutorial"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["ERGM Tutorial"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["David Simons"]},{"type":"character","attributes":{},"value":["https://github.com/diddrog11/rodent_trapping"]},{"type":"character","attributes":{},"value":["The Royal Veterinary College, London, UK"]},{"type":"character","attributes":{},"value":["https://www.rvc.ac.uk"]},{"type":"character","attributes":{},"value":["0000-0001-9655-1656"]}]}]},{"type":"character","attributes":{},"value":["2022-10-10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["contact.py","ergm_tutorial_files/anchor-4.2.2/anchor.min.js","ergm_tutorial_files/bowser-1.9.3/bowser.min.js","ergm_tutorial_files/distill-2.2.21/template.v2.js","ergm_tutorial_files/figure-html5/adding-degree-1.png","ergm_tutorial_files/figure-html5/median-ties-leadership-1.png","ergm_tutorial_files/figure-html5/produce-random-graph-1.png","ergm_tutorial_files/figure-html5/produce-random-graph-2.png","ergm_tutorial_files/figure-html5/produce-random-graph-3.png","ergm_tutorial_files/figure-html5/seilama-simple-1.png","ergm_tutorial_files/figure-html5/subsetting-network-1.png","ergm_tutorial_files/figure-html5/triangles-distribution-1.png","ergm_tutorial_files/figure-html5/visualise-network-1.png","ergm_tutorial_files/figure-html5/visualise-networks-1.png","ergm_tutorial_files/figure-html5/visualise-networks-2.png","ergm_tutorial_files/figure-html5/wealth-network-1.png","ergm_tutorial_files/header-attrs-2.14/header-attrs.js","ergm_tutorial_files/jquery-3.6.0/jquery-3.6.0.js","ergm_tutorial_files/jquery-3.6.0/jquery-3.6.0.min.js","ergm_tutorial_files/jquery-3.6.0/jquery-3.6.0.min.map","ergm_tutorial_files/popper-2.6.0/popper.min.js","ergm_tutorial_files/tippy-6.2.7/tippy-bundle.umd.min.js","ergm_tutorial_files/tippy-6.2.7/tippy-light-border.css","ergm_tutorial_files/tippy-6.2.7/tippy.css","ergm_tutorial_files/tippy-6.2.7/tippy.umd.min.js","ergm_tutorial_files/webcomponents-2.0.0/webcomponents.js","multinomial_model_fitting_fence.html"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="ergm_tutorial_files/header-attrs-2.14/header-attrs.js"></script>
  <script src="ergm_tutorial_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="ergm_tutorial_files/popper-2.6.0/popper.min.js"></script>
  <link href="ergm_tutorial_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="ergm_tutorial_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="ergm_tutorial_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="ergm_tutorial_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="ergm_tutorial_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="ergm_tutorial_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="ergm_tutorial_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"ERGM Tutorial","authors":[{"author":"David Simons","authorURL":"https://github.com/diddrog11/rodent_trapping","affiliation":"The Royal Veterinary College, London, UK","affiliationURL":"https://www.rvc.ac.uk","orcidID":"0000-0001-9655-1656"}],"publishedDate":"2022-10-10T00:00:00.000-07:00","citationText":"Simons, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>ERGM Tutorial</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  David Simons <a href="https://github.com/diddrog11/rodent_trapping"
class="uri">https://github.com/diddrog11/rodent_trapping</a> (The Royal
Veterinary College, London, UK)<a href="https://www.rvc.ac.uk"
class="uri">https://www.rvc.ac.uk</a>
  
<br/>2022-10-10
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#visualising-the-network"
id="toc-visualising-the-network">Visualising the network</a>
<ul>
<li><a href="#bernoulli-erdosrenyi-model"
id="toc-bernoulli-erdosrenyi-model">Bernoulli (Erdos/Renyi) model</a>
<ul>
<li><a href="#applied-to-my-data" id="toc-applied-to-my-data">Applied to
my data</a></li>
</ul></li>
<li><a href="#triad-formation" id="toc-triad-formation">Triad
formation</a>
<ul>
<li><a href="#applied-to-my-data-1"
id="toc-applied-to-my-data-1">Applied to my data</a></li>
</ul></li>
<li><a href="#nodal-covariates-effects-on-mean-degree"
id="toc-nodal-covariates-effects-on-mean-degree">Nodal covariates:
effects on mean degree</a>
<ul>
<li><a href="#applied-to-my-data-2"
id="toc-applied-to-my-data-2">Applied to my data</a></li>
</ul></li>
</ul></li>
<li><a href="#ergm-monograph" id="toc-ergm-monograph">ERGM monograph</a>
<ul>
<li><a href="#useful-modifications-to-ergm-functions"
id="toc-useful-modifications-to-ergm-functions">Useful modifications to
<code>ergm</code> functions</a></li>
<li><a href="#introduction-1"
id="toc-introduction-1">Introduction</a></li>
<li><a href="#building-a-useful-ergm"
id="toc-building-a-useful-ergm">Building a useful ERGM</a>
<ul>
<li><a href="#model-building" id="toc-model-building">Model
building</a></li>
<li><a href="#incorporating-node-attributes"
id="toc-incorporating-node-attributes">Incorporating node
attributes</a></li>
<li><a href="#predicting-probabilities"
id="toc-predicting-probabilities">Predicting probabilities</a></li>
<li><a href="#adding-interaction-terms"
id="toc-adding-interaction-terms">Adding interaction terms</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<p>The tutorial is accessed here - <a
href="https://statnet.org/Workshops/ergm_tutorial.html"
class="uri">https://statnet.org/Workshops/ergm_tutorial.html</a></p>
<p>ERGMs are formulated as:</p>
<p><span class="math display">\[\begin{align*}
\log({\exp(\theta&#39;g(y))}) = \theta_1g_1(y) + \theta_2g_2(y)+ ... +
\theta_pg_p(y)
\end{align*}\]</span></p>
<p>Where: + <span class="math inline">\(y\)</span> is the random
variable for the state of the network + <span
class="math inline">\(g(y)\)</span> is a vector of model statistics for
network y + <span class="math inline">\(\sigma\)</span> is the vector of
coefficients for those statistics, and + <span
class="math inline">\(k(\sigma)\)</span> represents the quantity in the
numerator summed over all possible networks(typically constrained to be
all networks with the same node set a <span
class="math inline">\(y\)</span>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://statnet.org'>ergm</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidygraph.data-imaginist.com'>tidygraph</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://mbojan.github.io/intergraph'>intergraph</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggraph.data-imaginist.com'>ggraph</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>florentine</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h1 id="visualising-the-network">Visualising the network</h1>
<p>The data is imported as a <code>network</code> object. We can
describe the structure of the network and then visualising it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>flomarriage</span></span></code></pre>
</div>
<pre><code> Network attributes:
  vertices = 16 
  directed = FALSE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  total edges= 20 
    missing edges= 0 
    non-missing edges= 20 

 Vertex attribute names: 
    priorates totalties vertex.names wealth 

No edge attributes</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>flomarriage</span>, </span>
<span>     main<span class='op'>=</span><span class='st'>"Florentine Marriage"</span>, </span>
<span>     cex.main<span class='op'>=</span><span class='fl'>0.8</span>, </span>
<span>     label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>network.vertex.names</a></span><span class='op'>(</span><span class='va'>flomarriage</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Plot the network</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/visualise-network-1.png" width="624" /></p>
</div>
<p>This displays the edges between all the nodes in the network.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>wealth</span> <span class='op'>&lt;-</span> <span class='va'>flomarriage</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>'wealth'</span> <span class='co'># %v% references vertex attributes</span></span>
<span><span class='va'>wealth</span></span></code></pre>
</div>
<pre><code> [1]  10  36  55  44  20  32   8  42 103  48  49   3  27  10 146  48</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>flomarriage</span>, </span>
<span>     vertex.cex<span class='op'>=</span><span class='va'>wealth</span><span class='op'>/</span><span class='fl'>25</span>, </span>
<span>     main<span class='op'>=</span><span class='st'>"Florentine marriage by wealth"</span>, cex.main<span class='op'>=</span><span class='fl'>0.8</span><span class='op'>)</span> <span class='co'># Plot the network with vertex size proportional to wealth</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/wealth-network-1.png" width="624" /></p>
</div>
<p>We can set the vertex of interest to wealth, here, this is the only
vertex property <code>%v%</code> is used to reference the vertex. The
size of a node is related to the value of wealth.</p>
<h2 id="bernoulli-erdosrenyi-model">Bernoulli (Erdos/Renyi) model</h2>
<p>The simplest model, containing only the one term that represents the
total number of edges in the network, <span
class="math inline">\(\sum{y_{ij}}\)</span> can be accessed by using the
ergm-term of <code>edges</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>flomarriage</span> <span class='op'>~</span> <span class='va'>edges</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>edges 
   20 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>flomodel.01</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>flomarriage</span> <span class='op'>~</span> <span class='va'>edges</span><span class='op'>)</span> <span class='co'># Estimate the model </span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>flomodel.01</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = flomarriage ~ edges)

Maximum Likelihood Results:

      Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges  -1.6094     0.2449      0  -6.571   &lt;1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 166.4  on 120  degrees of freedom
 Residual Deviance: 108.1  on 119  degrees of freedom
 
AIC: 110.1  BIC: 112.9  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>This simple model specifies a single homogenous probability for all
ties, captured by the coefficient of the <code>edges</code> term. This
can be interpreted by returning to the logit form of the ERGM. The
log-odds that a tie is present is:</p>
<p><span class="math display">\[\begin{align*}
{\sf{logit}(p(y))} &amp;= \sigma * \delta(g(y)) \\
&amp;= -1.61 * \text{change in the number of ties} \\
&amp;= -1.61 * 1
\end{align*}\]</span></p>
<p>for every tie, since the addition of any tie to the network always
increases the total number by 1. The corresponding probability is
obtained by taking the expit, or inverse logit, of <span
class="math inline">\(\sigma\)</span>:</p>
<p><span class="math display">\[\begin{align*}
&amp;= \sf {exp}(-1.61)/(1+ \sf {exp}(-1.61)) \\
&amp;= 0.167
\end{align*}\]</span></p>
<p>This probability corresponds to the density we observe in the
flomarriage network. There are 20 ties and therefore <span
class="math inline">\(\binom{16}{2} = (16 \times 15)/2 = 120\)</span>
dyads, so the probability of a tie is <span class="math inline">\(20/120
= 0.167\)</span></p>
<h3 id="applied-to-my-data">Applied to my data</h3>
<p>Applied to Seilama Grid 1 Visit 5.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>landuse_graph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_rds.html'>read_rds</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"graphs_landuse.rds"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>seilama_nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidygraph.data-imaginist.com/reference/tbl_graph.html'>as_tbl_graph</a></span><span class='op'>(</span><span class='va'>landuse_graph</span><span class='op'>$</span><span class='va'>agriculture</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidygraph.data-imaginist.com/reference/activate.html'>activate</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Village</span> <span class='op'>==</span> <span class='st'>"Seilama"</span> <span class='op'>&amp;</span></span>
<span>           <span class='va'>Grid</span> <span class='op'>==</span> <span class='st'>"1"</span> <span class='op'>&amp;</span></span>
<span>           <span class='va'>Visit</span> <span class='op'>==</span> <span class='st'>"5"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>rodent_graph</span> <span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/as.igraph.html'>as.igraph</a></span><span class='op'>(</span><span class='va'>seilama_nodes</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>rodent_graph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/intergraph/man/asNetwork.html'>asNetwork</a></span><span class='op'>(</span><span class='va'>rodent_graph</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>rodent_graph</span></span></code></pre>
</div>
<pre><code> Network attributes:
  vertices = 25 
  directed = FALSE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  total edges= 87 
    missing edges= 0 
    non-missing edges= 87 

 Vertex attribute names: 
    Grid Landuse Serostatus Species vertex.names Village Visit 

No edge attributes</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggraph.data-imaginist.com/reference/ggraph.html'>ggraph</a></span><span class='op'>(</span><span class='va'>rodent_graph</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggraph.data-imaginist.com/reference/geom_edge_link.html'>geom_edge_link</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggraph.data-imaginist.com/reference/geom_node_point.html'>geom_node_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>Species</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/seilama-simple-1.png" width="624" /></p>
</div>
<p>The graph has been filtered using <code>tidygraph</code> and
simplified in <code>igraph</code> prior to conversion to a
<code>network</code> object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'>~</span> <span class='va'>edges</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>edges 
   87 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>rodent.01</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'>~</span> <span class='va'>edges</span><span class='op'>)</span> <span class='co'># Estimate the model </span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rodent.01</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = rodent_graph ~ edges)

Maximum Likelihood Results:

      Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges  -0.8954     0.1272      0  -7.037   &lt;1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 415.9  on 300  degrees of freedom
 Residual Deviance: 361.3  on 299  degrees of freedom
 
AIC: 363.3  BIC: 367  (Smaller is better. MC Std. Err. = 0)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.895</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.895</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.2900791</code></pre>
</div>
<p>The probability of tie is 0.29. This is equivalent to the number of
ties 87 divided by the number of dyads <span
class="math inline">\(\binom{25}{2} = 300\)</span>.</p>
<h2 id="triad-formation">Triad formation</h2>
<p>A term can be added, one that represents clustering. The number of
completed triangles in the network. This is a dyad dependent term: the
status of any triangle containing dyan <span
class="math inline">\(y_{i,j}\)</span> depends on the status of dyads of
the <span class="math inline">\(y_{i,k}\)</span> and <span
class="math inline">\(y_{j,k}\)</span>. This means that any model
containing the ergm-term <code>triangle</code> has the proprty that
dyads are not probabilistically independent of one another. As a result,
<code>ergm</code> uses a stochastic MCMC-based algorithm.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>321</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>flomarriage</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='va'>triangles</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   edges triangle 
      20        3 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>flomodel.02</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>flomarriage</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='va'>triangles</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>flomodel.02</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = flomarriage ~ edges + triangles)

Monte Carlo Maximum Likelihood Results:

         Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges     -1.6900     0.3620      0  -4.668   &lt;1e-04 ***
triangle   0.1901     0.5982      0   0.318    0.751    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 166.4  on 120  degrees of freedom
 Residual Deviance: 108.1  on 118  degrees of freedom
 
AIC: 112.1  BIC: 117.6  (Smaller is better. MC Std. Err. = 0.01102)</code></pre>
</div>
<p>This can be interpreted as follows. The conditional log-odds of two
nodes having a ties, keeping the rest of the network fixed is.</p>
<p>\begin(align<em>) -1.68 </em> + 0.1603 * \end{align}</p>
<ul>
<li>for a tie that will create no triangles, the conditional log-odds
is: -1.68</li>
<li>if one triangle: -1.68 + 0.1603 = -1.5197</li>
<li>if two triangles: -1.68 + 2 * 0.204 = -1.272</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.02</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.02</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.1557799 0.1824455 0.2125265</code></pre>
</div>
<p>The three probabilities for these options are therefore: + 0.157 +
0.18 + 0.204</p>
<h3 id="applied-to-my-data-1">Applied to my data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'>~</span> <span class='va'>triangles</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>triangle 
     162 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>rodent.02</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'>~</span> <span class='va'>triangles</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rodent.02</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = rodent_graph ~ triangles)

Monte Carlo Maximum Likelihood Results:

         Estimate Std. Error MCMC % z value Pr(&gt;|z|)  
triangle -0.08263    0.03440      0  -2.402   0.0163 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 415.9  on 300  degrees of freedom
 Residual Deviance: 407.1  on 299  degrees of freedom
 
AIC: 409.1  BIC: 412.8  (Smaller is better. MC Std. Err. = 0.7768)</code></pre>
</div>
<p>This model <code>~ edges + triangles</code> cannot run for the data,
as it is unable to reach the target effective size in the number of
iterations alotted. Perhaps as the number of triangles exceeds the
number of edges? It has been run for <code>triangles</code> which works
ok.</p>
<h2 id="nodal-covariates-effects-on-mean-degree">Nodal covariates:
effects on mean degree</h2>
<p>Wealth appeared to be associated with higher degree. We can use
<code>ergm</code> to test this. Wealth is a nodal covariate, so we use
the ergm-term <code>nodecov</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   3.00   17.50   39.00   42.56   48.25  146.00 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>flomarriage</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodecov</span><span class='op'>(</span><span class='st'>"wealth"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>         edges nodecov.wealth 
            20           2168 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>flomodel.03</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>flomarriage</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodecov</span><span class='op'>(</span><span class='st'>"wealth"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = flomarriage ~ edges + nodecov(&quot;wealth&quot;))

Maximum Likelihood Results:

                Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges          -2.594929   0.536056      0  -4.841   &lt;1e-04 ***
nodecov.wealth  0.010546   0.004674      0   2.256   0.0241 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 166.4  on 120  degrees of freedom
 Residual Deviance: 103.1  on 118  degrees of freedom
 
AIC: 107.1  BIC: 112.7  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>This supports the initial observation. There is a significant
positive wealth effect on the probability of a tie. To interpret these
coefficients note that the wealth effect operates on both nodes of the
dyad. The conditional log-odds of a tie between two nodes is:</p>
<p><span class="math display">\[\begin{align*}
-2.59 * \text{change in the number of ties} + 0.01 * \text{the wealth of
node 1} + 0.01 * \text{the wealth of node 2} \\
-2.59 * \text{change in the number of ties} + 0.01 * {the sum of the
wealth of the two nodes}
\end{align*}\]</span></p>
<ul>
<li>for a tie between two nodes with minimum wealth, the conditional
log-odds is: -2.59 + 0.01 * (3+3) = -2.53</li>
<li>for a tie between two nodes with maximum wealth: -2.59 + 0.01 *
(146+146) = 0.33</li>
<li>for a tie between two nodes one with minimum wealth and one with
maximum wealth: -2.59 + 0.01 * (146+3) = 0.33</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.07366873</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.6188046</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>flomodel.03</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>wealth</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.2643291</code></pre>
</div>
<p>The corresponding probabilities are therefore 0.07, 0.61 and
0.26.</p>
<p>This model specification does not include a term for homophily by
wealth (a term accounting for similarity in wealth of the two end
nodes). It only specifies the relation between wealth and mean degree.
To specify homophily on wealth the term <code>absdiff</code> can be used
(see below).</p>
<h3 id="applied-to-my-data-2">Applied to my data</h3>
<p>My data is not continuous so need to use nodefactor instead of
nodecov. By default it will use Crocidura spp. as the reference.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>species</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"Species"</span><span class='op'>)</span></span>
<span><span class='va'>serostatus</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"Serostatus"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>species</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>      Crocidura spp Lophuromys sikapusi      Mus minutoides 
                  4                   4                   2 
        Praomys spp 
                 15 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>serostatus</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Negative 
      25 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodefactor</span><span class='op'>(</span><span class='st'>"Species"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                                 edges 
                                    87 
nodefactor.Species.Lophuromys sikapusi 
                                    20 
     nodefactor.Species.Mus minutoides 
                                    20 
        nodefactor.Species.Praomys spp 
                                   114 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>rodent.03</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>rodent_graph</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodefactor</span><span class='op'>(</span><span class='st'>"Species"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rodent.03</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = rodent_graph ~ edges + nodefactor(&quot;Species&quot;))

Maximum Likelihood Results:

                                         Estimate Std. Error MCMC %
edges                                  -1.829e+00  5.006e-01      0
nodefactor.Species.Lophuromys sikapusi  2.780e-16  3.639e-01      0
nodefactor.Species.Mus minutoides       1.064e+00  4.031e-01      0
nodefactor.Species.Praomys spp          6.004e-01  2.848e-01      0
                                       z value Pr(&gt;|z|)    
edges                                   -3.654 0.000258 ***
nodefactor.Species.Lophuromys sikapusi   0.000 1.000000    
nodefactor.Species.Mus minutoides        2.640 0.008284 ** 
nodefactor.Species.Praomys spp           2.108 0.035054 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 415.9  on 300  degrees of freedom
 Residual Deviance: 349.3  on 296  degrees of freedom
 
AIC: 357.3  BIC: 372.1  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>Coefficients are interpreted as: + Probability of Crocidura forming a
tie: -1.829 = probability of 0.13 + Probability of L. sikapusi forming a
tie: -1.829 + -2.1e-16 = probability of 0.13 + Probability of M.
minutoides forming a tie: -1.829 + 1.072 = probability of 0.32 +
Probability of Praomys forming a tie: -1.829 + 6.004e-1 = probability of
0.22</p>
<h1 id="ergm-monograph">ERGM monograph</h1>
<h2 id="useful-modifications-to-ergm-functions">Useful modifications to
<code>ergm</code> functions</h2>
<p>These are functions that exponentiate to produce Odds Ratios by
default, they are saved in <code>R/modified_functions.R</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"R"</span>, <span class='st'>"modified_functions.R"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="introduction-1">Introduction</h2>
<p>Networks may differ from simple random graphs due to the
following:</p>
<ul>
<li>Network members do not all have the same propensity to form ties
(non-uniform degree distribution).</li>
<li>Actors with similar characteristics are linked to one another more
often than expected by random chance (homophily)</li>
<li>The friend-of-my-friend-is-my-friend property is more common than
expected by random chance (transitivity)</li>
<li>Directed networks contain more reciprocal ties than expected at
random by chance alone (reciprocity)</li>
</ul>
<p>Degree distribution is often skewed right with most network members
having few ties and a few individuals having many. Transitivity is
represented in undirected networks by complete triad structures. Two
other structures in networks can help discern the presence or absence of
transitivity: edgewise shared partners (ESP) and dyadwise shared
partners (DSP). An ESP is a linked dyad where both members of the dyad
also have a link to a third network member. In any given triangle
structure there are three ESPs. The distribution of ESP in a network
shows how many connected dyads have one shared partner, two or more.
Likewise, the DSP distribution shows the number of dyads in the network
with one or more shared partners. Observed networks tend to include
dyads with more shared partners than random networks include,
demonstrating more transitivity and pretransitive structures than would
occur by chance.</p>
<p>The underlying assumption of a simple random graph model is that the
ties between network members occur at random and are independent of one
another.</p>
<p>To incorporate higher level conditional dependence the, Geometrically
Weighted Degree distribution (GWD), Geometrically Weighted Edgewise
Shared Partnerships (GWESP), and Geometrically Weighted Dyadwise Shared
Partnerships (GWDSP) can be incorporated into models. The GWD was
designed to account for the decreasing degree distribution in observed
networks. The statistic multiplies the frequency for each value of
degree by a weighting parameter and sums the values. Two things
influence the size of the GWD statistic, firstly the proportion of
high-degree nodes in the network and a selected value of a decay
parameter.</p>
<p>GWESP was developed to capture patterns of transitivity. GWESP
accounts for the transitivity associated with clustering. GWDSP accounts
for the number of dyads with shared partners as DSP are also found in
clusters.</p>
<h2 id="building-a-useful-ergm">Building a useful ERGM</h2>
<p>National Association of County and City Health Officials (NACCHO)
data will be used. Containing data on Local Health Departments (LHDs)
structure, finances, leadership and staffing.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>ergmharris</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://statnet.org'>sna</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>lhds</span><span class='op'>)</span></span>
<span><span class='va'>lhds</span></span></code></pre>
</div>
<pre><code> Network attributes:
  vertices = 1283 
  directed = FALSE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  title = lhds 
  total edges= 2708 
    missing edges= 0 
    non-missing edges= 2708 

 Vertex attribute names: 
    hivscreen nutrition popmil state vertex.names years 

 Edge attribute names not shown </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>max.print <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lhds</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Network attributes:
  vertices = 1283
  directed = FALSE
  hyper = FALSE
  loops = FALSE
  multiple = FALSE
  bipartite = FALSE
  title = lhds
 total edges = 2708 
   missing edges = 0 
   non-missing edges = 2708 
 density = 0.00329279 

Vertex attributes:

 hivscreen:
   character valued attribute
   attribute summary:
  N   Y 
461 804 

 nutrition:
   character valued attribute
   attribute summary:
  N   Y 
326 941 

 popmil:
   numeric valued attribute
   attribute summary:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.00055  0.01722  0.04094  0.15865  0.12874 10.11107 

 state:
   character valued attribute
   attribute summary:
   the 10 most common values are:
MO OH MA IL KS NJ WI NC FL MN 
73 72 66 63 63 62 62 57 49 49 
  vertex.names:
   character valued attribute
   1283 valid vertex names

 years:
   integer valued attribute
   1283 values

No edge attributes

Network edgelist matrix:
        [,1] [,2]
   [1,]    2   10
   [2,]    2   11
   [3,]    2   19
   [4,]    2   20
   [5,]    5 1003
 [ reached getOption(&quot;max.print&quot;) -- omitted 2703 rows ]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>max.print <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>This is a network of 1,283 nodes, that is undirected with 2,708
edges. This network can be visualised with node colour showing LHD
attributes. There is some apparent clustering in the network. For
example an LHD may be more likely to communicate with an LHD sharing the
same state. Similar is apparent with clustering on HIV screening
programmes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lhds</span>, vertex.col <span class='op'>=</span> <span class='st'>"state"</span>, main <span class='op'>=</span> <span class='st'>"State"</span><span class='op'>)</span></span></code></pre>
</div>
<img src="ergm_tutorial_files/figure-html5/visualise-networks-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lhds</span>, vertex.col <span class='op'>=</span> <span class='st'>"hivscreen"</span>, main <span class='op'>=</span> <span class='st'>"HIV Screening Programmes"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/visualise-networks-2.png" width="624" /></p>
</div>
<p>In larger networks it may be useful to just try and visualise the
largest component of the network rather than the entirety of the
network.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Logical term to determine whether the node is part of the largest component</span></span>
<span><span class='va'>lhdscomp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/component.dist.html'>component.largest</a></span><span class='op'>(</span><span class='va'>lhds</span><span class='op'>)</span></span>
<span><span class='co'># Filter based on this</span></span>
<span><span class='va'>lhdssmall</span> <span class='op'>&lt;-</span> <span class='va'>lhds</span><span class='op'>[</span><span class='va'>lhdscomp</span>, <span class='va'>lhdscomp</span><span class='op'>]</span></span>
<span><span class='co'># Convert this to a network object</span></span>
<span><span class='va'>smallnet</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/network.html'>as.network</a></span><span class='op'>(</span><span class='va'>lhdssmall</span>, directed <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Extract the HIV screening data</span></span>
<span><span class='va'>hivscreen</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"hivscreen"</span><span class='op'>)</span></span>
<span><span class='co'># Turn this into a vector removing those not in the largest component</span></span>
<span><span class='va'>subhiv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>hivscreen</span>, <span class='va'>lhdscomp</span> <span class='op'>!=</span> <span class='st'>"FALSE"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># Create a vertex attribute for this vector</span></span>
<span><span class='va'>smallnet</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"hivscreen"</span> <span class='op'>&lt;-</span> <span class='va'>subhiv</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>smallnet</span>, vertex.col <span class='op'>=</span> <span class='st'>"hivscreen"</span>, main <span class='op'>=</span> <span class='st'>"HIV screening in the largest network component"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/subsetting-network-1.png" width="624" /></p>
</div>
Vertex size and shape can also be used to convey information. Node size
should only be determined by continuous or ordinal variables, nominal
variables can be used with colour and shape. Further, network measures
can be used to size the nodes, for example degree, the number of links a
network member has.
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>numties</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span>, gmode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span></span>
<span><span class='va'>lhds</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"numties"</span> <span class='op'>&lt;-</span> <span class='va'>numties</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lhds</span>, vertex.col <span class='op'>=</span> <span class='st'>"hivscreen"</span>, vertex.cex <span class='op'>=</span> <span class='va'>numties</span><span class='op'>/</span><span class='fl'>6</span>, main <span class='op'>=</span> <span class='st'>"HIV screening in entire network, \ndegree is divided by 6 to reduce overlap"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/adding-degree-1.png" width="624" /></p>
</div>
Network descriptives such as the mean and sd of degree, the distribution
of degrees and the distribution of triads are helpful to understand the
network.
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"mean_degree"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span>, gmode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     <span class='st'>"sd_degree"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span>, gmode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     <span class='st'>"degree_table"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span>, gmode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     <span class='st'>"triad_table"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/triad.census.html'>triad.census</a></span><span class='op'>(</span><span class='va'>lhds</span>, mode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>$mean_degree
[1] 4.221356

$sd_degree
[1] 2.895897

$degree_table

  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16 
 58 117 182 223 226 172 104  67  35  25  26  14   8   6   8   4   3 
 17  18  19  20  22 
  1   1   1   1   1 

$triad_table
             0       1    2    3
[1,] 347709795 3445061 9788 1437</code></pre>
</div>
<p>Graphic examination of degree, edgewise shared partners (ESP), and
dyadwise shared partners (DSP) are useful. The distribution of degree
shows many low-degree nodes and a few high-degree nodes compared with a
random network of the same size and density.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lhd_degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"degree"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span>, gmode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>degree</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distribution of degree (LHD)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>randomg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/rgraph.html'>rgraph</a></span><span class='op'>(</span><span class='fl'>1283</span>, <span class='fl'>1</span>, tprob <span class='op'>=</span> <span class='fl'>0.0033</span>, mode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span></span>
<span><span class='va'>randomnet</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/network.html'>as.network</a></span><span class='op'>(</span><span class='va'>randomg</span>, directed <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='va'>randomnet</span></span></code></pre>
</div>
<pre><code> Network attributes:
  vertices = 1283 
  directed = FALSE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  total edges= 2805 
    missing edges= 0 
    non-missing edges= 2805 

 Vertex attribute names: 
    vertex.names 

 Edge attribute names not shown </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>random_degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"degree"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>randomnet</span>, gmode <span class='op'>=</span> <span class='st'>"graph"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>degree</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distribution of degree (Random)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>lhd_degree</span>, <span class='va'>random_degree</span><span class='op'>)</span></span></code></pre>
</div>
<img src="ergm_tutorial_files/figure-html5/produce-random-graph-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>null_random</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>randomnet</span> <span class='op'>~</span> <span class='va'>edges</span><span class='op'>)</span></span>
<span><span class='va'>gof_null_random</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/gof.html'>gof</a></span><span class='op'>(</span><span class='va'>null_random</span>, GOF <span class='op'>=</span> <span class='op'>~</span> <span class='va'>degree</span> <span class='op'>+</span> <span class='va'>distance</span> <span class='op'>+</span> <span class='va'>espartners</span> <span class='op'>+</span> <span class='va'>dspartners</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lhdforesp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>lhds</span> <span class='op'>~</span> <span class='va'>edges</span><span class='op'>)</span></span>
<span><span class='va'>gof_lhdforesp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/gof.html'>gof</a></span><span class='op'>(</span><span class='va'>lhdforesp</span>, GOF <span class='op'>=</span> <span class='op'>~</span> <span class='va'>degree</span> <span class='op'>+</span> <span class='va'>distance</span> <span class='op'>+</span> <span class='va'>espartners</span> <span class='op'>+</span> <span class='va'>dspartners</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lhd_dsp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gof_lhdforesp</span><span class='op'>$</span><span class='va'>obs.dspart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                  dsp <span class='op'>=</span> <span class='va'>gof_lhdforesp</span><span class='op'>$</span><span class='va'>obs.dspart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>name</span>, y <span class='op'>=</span> <span class='va'>dsp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distribution of DSP1-4 (LHD)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>random_dsp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gof_null_random</span><span class='op'>$</span><span class='va'>obs.dspart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                  dsp <span class='op'>=</span> <span class='va'>gof_null_random</span><span class='op'>$</span><span class='va'>obs.dspart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>name</span>, y <span class='op'>=</span> <span class='va'>dsp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distribution of DSP1-4 (Random)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>lhd_dsp</span>, <span class='va'>random_dsp</span><span class='op'>)</span>  </span></code></pre>
</div>
<img src="ergm_tutorial_files/figure-html5/produce-random-graph-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lhd_esp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gof_lhdforesp</span><span class='op'>$</span><span class='va'>obs.espart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                  esp <span class='op'>=</span> <span class='va'>gof_lhdforesp</span><span class='op'>$</span><span class='va'>obs.espart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>name</span>, y <span class='op'>=</span> <span class='va'>esp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distribution of ESP1-4 (LHD)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>random_esp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gof_null_random</span><span class='op'>$</span><span class='va'>obs.espart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                  esp <span class='op'>=</span> <span class='va'>gof_null_random</span><span class='op'>$</span><span class='va'>obs.espart</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>name</span>, y <span class='op'>=</span> <span class='va'>esp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Distribution of ESP1-4 (Random)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/plot_grid.html'>plot_grid</a></span><span class='op'>(</span><span class='va'>lhd_esp</span>, <span class='va'>random_esp</span><span class='op'>)</span>  </span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/produce-random-graph-3.png" width="624" /></p>
</div>
<p>Edgewise and Dyyadwise shared partner distributions also differ in
the observed and random networks, with the observed LHD network having
more network members with multiple DSP and ESP compared with the random
network, which shows a large number of nodes with a single shared
partner and little else in terms of shared partners.</p>
<p>The network has shown potential clustering, another option for
identifying clustering is to examine mixing matrices and correlation
coefficients.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/network/man/mixingmatrix.html'>mixingmatrix</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"state"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>    AK  AL  AR  AZ  CA  CO  CT  FL  GA  IA  ID  IL  IN  KS  KY  LA
AK   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
AL   0  31   0   1   1   0   0   7   1   0   0   0   0   1   0   0
AR   0   0  30   0   0   0   0   0   0   0   0   0   0   0   0   0
AZ   0   1   0  27   0   0   0   0   0   0   0   1   0   0   0   0
CA   0   1   0   0  56   0   0   1   0   0   0   0   0   1   1   0
CO   0   0   0   0   0 122   1   0   0   0   0   0   0   0   0   0
CT   0   0   0   0   0   1  64   0   0   0   0   0   0   0   0   0
FL   0   7   0   0   1   0   0 139   1   0   0   0   0   0   0   0
GA   0   1   0   0   0   0   0   1  10   0   0   0   0   0   1   0
IA   0   0   0   0   0   0   0   0   0  52   0   1   0   3   0   0
    MA  MD  ME  MI  MN  MO  MS  MT  NC  ND  NE  NH  NJ  NM  NV  NY
AK   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
AL   0   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0
AR   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
AZ   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1   0
CA   1   3   0   1   1   0   0   0   0   0   0   0   0   0   1   2
CO   5   0   0   1   0   1   0   0   0   0   0   0   0   0   0   0
CT   2   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
FL   0   1   0   0   0   1   0   0   1   0   0   0   0   0   0   1
GA   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
IA   0   0   0   0   1   3   0   0   0   0   1   0   0   0   0   0
    OH  OK  OR  PA  SC  SD  TN  TX  UT  VA  WA  WI  WV  WY
AK   0   0   0   0   0   0   0   0   0   0   0   0   0   0
AL   0   1   0   0   0   0   0   0   0   0   0   0   0   0
AR   0   0   0   0   0   0   0   0   0   0   0   0   0   0
AZ   0   0   0   0   0   0   0   0   1   0   0   0   0   0
CA   2   0   0   1   0   0   0   0   0   0   6   0   0   0
CO   0   0   0   0   0   0   0   1   0   0   0   0   0   0
CT   0   0   0   0   0   0   0   0   0   0   0   0   0   0
FL   1   0   0   0   0   0   0   0   0   0   0   1   0   0
GA   0   0   0   0   0   0   2   0   0   0   0   0   0   0
IA   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 [ reached getOption(&quot;max.print&quot;) -- omitted 36 rows ]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/network/man/mixingmatrix.html'>mixingmatrix</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"hivscreen"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>        N    Y &lt;NA&gt;
N     526  632   20
Y     632 1498   32
&lt;NA&gt;   20   32    0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/network/man/mixingmatrix.html'>mixingmatrix</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"nutrition"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>        N    Y &lt;NA&gt;
N     216  648    7
Y     648 1812   25
&lt;NA&gt;    7   25    0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/network/man/mixingmatrix.html'>mixingmatrix</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"years"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>       0   1   2   3 &lt;NA&gt;
0     71 190 207 283   15
1    190 120 259 355   10
2    207 259 225 516   16
3    283 355 516 389   51
&lt;NA&gt;  15  10  16  51    1</code></pre>
</div>
<p>From the mixing matrices we can see that of the connected dyads 1,812
are connections between two LHDs doing nutrition programming, while 648
include an LHD doing a nutrition programme and on not doing a programme.
This demonstrates a propensity for LHDs with similar programmes to be
connected (homophily of programming). The HIV mixing matrix shows a
similar pattern. The leaders years of experience matrix differs from the
others. LHDs with more experienced leaders seem to have more connections
with all other experience groups. For example, of the 751 connected
dyads including a leader with the lowest experience level 283 (38%) are
with an LHD with a leader in the top experience category. In contrast,
of the 1,543 connected dyads that include an LHD with a highly
experienced leader just 18.3% include an LHD with a low-experience
leader. This possibly easier to view as mean number of connections.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>years</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"years"</span><span class='op'>)</span></span>
<span><span class='va'>deg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>years <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>years</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1-2"</span>, <span class='st'>"3-5"</span>, <span class='st'>"6-10"</span>, <span class='st'>"10+"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>       degree <span class='op'>=</span> <span class='va'>deg</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>years</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>degree <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>degree</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>years</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>years</span>, y <span class='op'>=</span> <span class='va'>degree</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Mean degree by years of experience"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/median-ties-leadership-1.png" width="624" /></p>
</div>
<p>Further examination of node characteristics can be beneficial. For
example, for continuous attributes, such as <code>popmill</code> it may
be useful to examine the correlation between the attribute and degree.
Here, the correlation coefficient indicates that, as population
increases, the number of connections also increases. It may also be
useful to examine the average number of ties for nodes with different
attributes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>popmil</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"popmil"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>degree <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>lhds</span><span class='op'>)</span>,</span>
<span>       popmil <span class='op'>=</span> <span class='va'>popmil</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>          degree    popmil
degree 1.0000000 0.2727591
popmil 0.2727591 1.0000000</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>years</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"years"</span><span class='op'>)</span></span>
<span><span class='va'>nutrition</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"nutrition"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>years</span>, <span class='va'>nutrition</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>     nutrition
years   N   Y
    0  47 192
    1  63 200
    2  85 238
    3 119 296</code></pre>
</div>
<p>These exploratory tools allow us to identify components that may be
useful during the model-building process. First the network shows
extensive homophily by state and moderate homophily by program area.
Second, LHDs with more experienced leaders have more connections;
likewise, LHDs serving larger populations have more connections.
Finally, underlying structural features in the LHD network are notably
different from those in a random network of the same size and density.
Specifically, the degree distribution is non-uniform, including more
nodes with low degree and a few nodes with very high degree. There are
also more nodes with multiple ESP and DSP in the LHD network compared
with the random network, indicating higher rates of transitivity and
pretransitivity than expected by chance. The presence of homophily, a
non-uniform degree distribution, and transitivity are all consistent
with current network theory and modelling strategies.</p>
<h3 id="model-building">Model building</h3>
<p>We start with a null model. The null model is a simple random graph
model, consisting of a single term representing edges, or ties.</p>
<p><span class="math display">\[ \text{logit}(P(Y_{ij} =
1|n_\text{actors}, Y^{c}_{ij})) = \theta_{edges}\delta_{edges}
\]</span></p>
<p>Here <span class="math inline">\(\delta_{edges}\)</span> is the
change statistic for the edges term, and <span
class="math inline">\(\theta_{edges}\)</span> represents the coefficient
of the edges term. The null model includes the edges coefficient.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>null_random</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = randomnet ~ edges)

Maximum Likelihood Results:

      Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges -5.67741    0.01891      0  -300.2   &lt;1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 1140093  on 822403  degrees of freedom
 Residual Deviance:   37470  on 822402  degrees of freedom
 
AIC: 37472  BIC: 37483  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>Using the following equation.</p>
<p><span class="math display">\[ \text{logit}(P(Y_{ij} =
1|n_\text{actors}, Y^{c}_{ij})) = \sum_{k=1}^{\kappa} \theta_k
\delta_{z_k(y)}\]</span></p>
<p>The right hand side equates to <span class="math inline">\(k\)</span>
the number of network statistics in the model, <span
class="math inline">\(\kappa\)</span> being the total number in the
model. <span class="math inline">\(\delta_{z_k(y)}\)</span> represents
the change in the network statistic when a tie is added between <span
class="math inline">\(i\)</span> and <span
class="math inline">\(j\)</span>, that is, as <span
class="math inline">\(Y_{ij}\)</span> goes from 0 to 1. This d
statistic, called the change statistic is key to the interpretation of
these <span class="math inline">\(p^*\)</span> models. On the left, the
<span class="math inline">\(|\)</span> notation indicates that the
probability of <span class="math inline">\(Y_{ij} = 1\)</span> is
conditional on the rest of the network, where <span
class="math inline">\(Y^{c}_{ij}\)</span> denotes all dyads in the
network other than <span class="math inline">\(Y_{ij}\)</span>. The
<span class="math inline">\(\text{logit}\)</span> transformation allows
this to be restructured so the conditional probability of a ties is
equivalent to.</p>
<p><span class="math display">\[P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) =
\text{logistic}(\theta_1 \delta_{z_1(y)} + \theta_2 \delta_{z_2(y)}
...)\]</span></p>
<p>Using these equations, the probability of a tie in this network can
be calculated from the information in the summary. There is a single
term, edges. The estimate is the coefficient <span
class="math inline">\((\theta)\)</span> for each term, here -5.71272.
Indicating that the density of the network is below 50%, where an edges
term of 0 would represent a 50% or 0.5 density. A negative edges
coefficient is a typical feature of an observed network. The change
statistic (d) represents the change in the statistic of interest when an
edge is added. The edges term will always have the same change
statistic, <span class="math inline">\(\delta_{ed} = 1\)</span>. Using
the logistic regression model approach of</p>
<p><span class="math display">\[\displaystyle \frac{1}{1 + e^{-(\theta_1
X_1)}}\]</span></p>
<p>The probability of a new tie is estimated using:</p>
<p><span class="math display">\[P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) =
\displaystyle \frac{1}{1 + e^{-(-5.71272 * 1)}} = 0.003293\]</span></p>
<p>Producing a probability of a tie being, as expected, the same as the
density of the LHD network. Therefore, the null model is a good
representation of the observed density of the LHD network,it is unlikely
though to be a good representation of other observed network
characteristics. We can simulate networks using this model to look for
how well the model captures structures (i.e.triangles).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>simtrinull</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>null_random</span>, nsim <span class='op'>=</span> <span class='fl'>100</span>, monitor <span class='op'>=</span> <span class='op'>~</span> <span class='va'>triangles</span>, output <span class='op'>=</span> <span class='st'>"stats"</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/control.simulate.ergm.html'>control.simulate.ergm</a></span><span class='op'>(</span>MCMC.burnin <span class='op'>=</span> <span class='fl'>1000</span>,</span>
<span>                                                                                                                          MCMC.interval <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>,</span>
<span>                        seed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span></span>
<span><span class='va'>lhds.tri</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lhds</span> <span class='op'>~</span> <span class='va'>triangle</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>simtrinull</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>triangle</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>lhds.tri</span><span class='op'>)</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Triangles"</span>,</span>
<span>       y <span class='op'>=</span> <span class='st'>"Number of simulations"</span>,</span>
<span>       title <span class='op'>=</span> <span class='st'>"Simulated triangles, dashed line is observed triangles"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="ergm_tutorial_files/figure-html5/triangles-distribution-1.png" width="624" /></p>
</div>
<p>Clearly the model does not capture the transitivity of the observed
LHD network. A more complex model is thus needed.</p>
<h3 id="incorporating-node-attributes">Incorporating node
attributes</h3>
<p>Descriptive statistics indicated that leader experience and
population size may influence the number of ties an LHD has. To examine
the influence of these node attributes on the likelihood of a tie, they
are added to the model as main effects. Hypothesis testing the main
effects of LHD attributes on the likelihood of a connection might be
worded as:</p>
<ul>
<li>H0: There is no association between jurisdiction population and the
likelihood of an LHD to form ties</li>
<li>H1: There is an association between jurisdiction population and the
likelihood of an LHD to form ties</li>
</ul>
<p>When adding main effects the appropriate command for the data type
must be used. There is a comprehensive list of available
<code>statnet</code> terms and directions for their use. For the LHD
network model, leader experience will be included as a categorical model
and jurisdiction as a continuous predictor. In <code>statnet</code>,
<code>nodefactor</code> is used for categorical main effects and
continuous main effects use <code>nodecov</code>.
<code>nodefactor</code> adds multiple statistics to the model, each one
equal to the number of times a node with the specified attribute is at
one end of an edge. The <code>nodecov</code> main effect term adds one
network statistic to the model that sums the attribute of interest for
the two nodes comprising the endpoints of each edge in the network. For
example, if edge <span class="math inline">\(ij\)</span> consisted of an
LHD with a population of 1.2 million and an LHD with a population of
500,000, the edge would sum to 1.7 million which would be added to the
network statistic representing jurisdiction population.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>na_years</span> <span class='op'>&lt;-</span> <span class='va'>lhds</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"years"</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"0"</span>, <span class='st'>"1"</span>, <span class='st'>"2"</span>, </span>
<span>                                    <span class='st'>"3"</span>, <span class='st'>"4"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lhds_dat</span> <span class='op'>&lt;-</span> <span class='va'>lhds</span><span class='op'>[</span><span class='va'>na_years</span>, <span class='va'>na_years</span><span class='op'>]</span></span>
<span><span class='va'>lhds_dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/network.html'>as.network</a></span><span class='op'>(</span><span class='va'>lhds_dat</span>, directed <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>years</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"years"</span><span class='op'>)</span></span>
<span><span class='va'>years</span> <span class='op'>&lt;-</span> <span class='va'>years</span><span class='op'>[</span><span class='va'>na_years</span><span class='op'>]</span></span>
<span><span class='va'>lhds_dat</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"years"</span> <span class='op'>&lt;-</span> <span class='va'>years</span></span>
<span></span>
<span><span class='va'>pop</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"popmil"</span><span class='op'>)</span></span>
<span><span class='va'>pop</span> <span class='op'>&lt;-</span> <span class='va'>pop</span><span class='op'>[</span><span class='va'>na_years</span><span class='op'>]</span></span>
<span><span class='va'>lhds_dat</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"popmil"</span> <span class='op'>&lt;-</span> <span class='va'>pop</span></span>
<span></span>
<span><span class='va'>hiv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"hivscreen"</span><span class='op'>)</span></span>
<span><span class='va'>hiv</span> <span class='op'>&lt;-</span> <span class='va'>hiv</span><span class='op'>[</span><span class='va'>na_years</span><span class='op'>]</span></span>
<span><span class='va'>lhds_dat</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"hivscreen"</span> <span class='op'>&lt;-</span> <span class='va'>hiv</span></span>
<span></span>
<span><span class='va'>nut</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/network/man/attribute.methods.html'>get.vertex.attribute</a></span><span class='op'>(</span><span class='va'>lhds</span>, <span class='st'>"nutrition"</span><span class='op'>)</span></span>
<span><span class='va'>nut</span> <span class='op'>&lt;-</span> <span class='va'>nut</span><span class='op'>[</span><span class='va'>na_years</span><span class='op'>]</span></span>
<span><span class='va'>lhds_dat</span> <span class='op'><a href='https://rdrr.io/pkg/network/man/network.extraction.html'>%v%</a></span> <span class='st'>"nutrition"</span> <span class='op'>&lt;-</span> <span class='va'>nut</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>max.print <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lhds_dat</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Network attributes:
  vertices = 1256
  directed = FALSE
  hyper = FALSE
  loops = FALSE
  multiple = FALSE
  bipartite = FALSE
 total edges = 2615 
   missing edges = 0 
   non-missing edges = 2615 
 density = 0.003317938 

Vertex attributes:

 hivscreen:
   character valued attribute
   attribute summary:
  N   Y 
449 791 

 nutrition:
   character valued attribute
   attribute summary:
  N   Y 
314 926 

 popmil:
   numeric valued attribute
   attribute summary:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.00055  0.01755  0.04109  0.16026  0.12865 10.11107 
  vertex.names:
   character valued attribute
   1256 valid vertex names

 years:
   integer valued attribute
   1256 values

No edge attributes

Network edgelist matrix:
        [,1] [,2]
   [1,]   10    2
   [2,]   11    2
   [3,]   12    2
   [4,]   17    2
   [5,]   19    2
 [ reached getOption(&quot;max.print&quot;) -- omitted 2610 rows ]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>max.print <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>maineffects</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>lhds_dat</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodecov</span><span class='op'>(</span><span class='st'>"popmil"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodefactor</span><span class='op'>(</span><span class='st'>"years"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>maineffects</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = lhds_dat ~ edges + nodecov(&quot;popmil&quot;) + nodefactor(&quot;years&quot;))

Maximum Likelihood Results:

                   Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges              -6.23778    0.06792      0 -91.842  &lt; 1e-04 ***
nodecov.popmil      0.19799    0.01442      0  13.733  &lt; 1e-04 ***
nodefactor.years.1  0.15761    0.04676      0   3.371 0.000749 ***
nodefactor.years.2  0.29161    0.04394      0   6.636  &lt; 1e-04 ***
nodefactor.years.3  0.33408    0.04176      0   8.001  &lt; 1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 1092594  on 788140  degrees of freedom
 Residual Deviance:   34886  on 788135  degrees of freedom
 
AIC: 34896  BIC: 34954  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>In the statnet package, the reference group is the first in the list
shown in the summary of the network. Here, 1-2 years is the reference
with the regerence group omitted from the summary and estimates produced
for the other categories. The reference level can be changed within the
<code>ergm</code> functions using,
<code>nodefactor("years", base = 4)</code>. The output of the summary
function can be modified to meet what is expected when reporting these
models.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>or</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>maineffects</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span></span>
<span><span class='va'>ste</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>maineffects</span><span class='op'>$</span><span class='va'>covar</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>lci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>maineffects</span><span class='op'>$</span><span class='va'>coefficients</span> <span class='op'>-</span> <span class='fl'>1.96</span><span class='op'>*</span><span class='va'>ste</span><span class='op'>)</span></span>
<span><span class='va'>uci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>maineffects</span><span class='op'>$</span><span class='va'>coefficients</span> <span class='op'>+</span> <span class='fl'>1.96</span><span class='op'>*</span><span class='va'>ste</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>oddsratios</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>lci</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>or</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>uci</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>oddsratios</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>oddsratios</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>oddsratios</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lower"</span>, <span class='st'>"OR"</span>, <span class='st'>"Upper"</span><span class='op'>)</span></span>
<span><span class='va'>oddsratios</span></span></code></pre>
</div>
<pre><code>                    Lower     OR  Upper
edges              0.0017 0.0020 0.0022
nodecov.popmil     1.1850 1.2189 1.2539
nodefactor.years.1 1.0682 1.1707 1.2831
nodefactor.years.2 1.2281 1.3386 1.4590
nodefactor.years.3 1.2869 1.3967 1.5158</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>teststat</span> <span class='op'>&lt;-</span> <span class='va'>maineffects</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>/</span><span class='va'>ste</span></span>
<span><span class='va'>teststats</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>teststat</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>teststats</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>teststats</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>teststats</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Wald"</span><span class='op'>)</span></span>
<span><span class='va'>teststats</span></span></code></pre>
</div>
<pre><code>                       Wald
edges              -91.8417
nodecov.popmil      13.7333
nodefactor.years.1   3.3708
nodefactor.years.2   6.6361
nodefactor.years.3   8.0008</code></pre>
</div>
<p>According to the main effects model, LHDs with leaders who have 3-5
years of experience are 1.17 times more likely to form a tie with a
given LHD compared to LHDs with leaders with 1-2 years of experience.
Similarly, leaders with 10 years of experience are 1.4 times more likely
to connected to a given LHD compared to those with 1-2 years of
experience.</p>
<p>Further information is produced within the <code>ergm</code> model
which can be viewed using <code>names()</code>, with explanations from
<code>help(ergm)</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>maineffects</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1] &quot;coefficients&quot;    &quot;iterations&quot;      &quot;MCMCtheta&quot;      
 [4] &quot;gradient&quot;        &quot;hessian&quot;         &quot;covar&quot;          
 [7] &quot;failure&quot;         &quot;mple.lik&quot;        &quot;mple.lik.null&quot;  
[10] &quot;call&quot;            &quot;ergm_version&quot;    &quot;offset&quot;         
[13] &quot;MPLE_is_MLE&quot;     &quot;drop&quot;            &quot;estimable&quot;      
[16] &quot;network&quot;         &quot;reference&quot;       &quot;newnetwork&quot;     
[19] &quot;formula&quot;         &quot;constrained&quot;     &quot;constraints&quot;    
[22] &quot;obs.constraints&quot; &quot;nw.stats&quot;        &quot;etamap&quot;         
[25] &quot;estimate&quot;        &quot;estimate.desc&quot;   &quot;control&quot;        
[28] &quot;null.lik&quot;        &quot;mle.lik&quot;        </code></pre>
</div>
<p>Based on the main effects model, the null hypothesis is rejected in
favour of the alternate hypothesis. There is a significant association
between the likelihood of formaing a tie and LHD jurisdiction
population. For every additional 1 million people, the likelihood of
forming a tie increases 1.22 times, all else held constant (OR = 1.22,
95% C.I. = 1.19-1.25).</p>
<h3 id="predicting-probabilities">Predicting probabilities</h3>
<p>As with the null model, the main effects model can be used to predict
the probability of a new tie formation between any two network members.
Because attributes of the network members are now included in the model,
the predicted probability of a tie can now be calculated for network
members with specified characteristics. For main effects predictors, the
change statistic for each term is relatively straightforward. If the
predictor is categorical, the value of the change statistic is 0, 1, or
2. If neither of the members in the dyad has a characteristic of
interest is is 0. A value of 1 indicates that one of the nodes in the
dyad has the characteristic, a 2 indicates that both nodes in the dyad
have this characteristic. In the LHD network, for a link between two
LHDs with highly experienced leaders, the coefficient for
<code>nodefactor.years.3</code> would be multiplied by the change
statistic of 2 to represent two LHDs with this characteristic; for a
link between an LHD with a very experience leader and one with a new
leader, the <code>nodefactor.years.3</code> coefficient would be
multiplied by 1 to represent the one LHD with the experienced leader;
and so on. The <span class="math inline">\(\delta\)</span> corresponding
to a categorical node attribute may be summarised as follows:</p>
<p><span class="math display">\[
\delta_{cat} = \text{2 if nodes } i \text{ and } j \text{ have the
characteristic} \\
\delta_{cat} = \text{1 if nodes } i \text{ or } j \text{ have the
characteristic} \\
\delta_{cat} = \text{0 if neither nodes } i \text{ nor } j \text{ have
the characteristic} \\
\]</span></p>
<p>For continuous predictors, <span
class="math inline">\(\delta\)</span> represents the sum of the
characteristic for the two LHD leaders in the dyad. In the case of the
LHD network, jurisdiction population is a continuous predictor, so if
one LHD had 1 million and the other .5 million, the <span
class="math inline">\(\delta_{popmil}\)</span> would be <span
class="math inline">\(1 + 0.5 = 1.5\)</span>. To find the predicted
probability of a tie between:</p>
<ol type="1">
<li>An LHD in a jurisdiction with 2 million people with a leader who had
been there 7 years (years = 2). And.</li>
<li>An LHD in a jurisdiction with 100,000 people with a leader who had
been there 1 year (years = 0).</li>
</ol>
<p>The coefficients would be multiplied by the change statistics for
each term.</p>
<p><span class="math display">\[
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) =
\text{logistic}(\theta_{edges}\delta_{edges} +
\theta_{popmil}\delta_{popmil} + \theta_{\text3-5
years}\delta_{\text{3-5 years}} + \theta_{\text{6-10
years}}\delta_{\text{6-10 years}} + \theta_{\text{&gt;10
years}}\delta_{\text{&gt;10 years}}) \\
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) =
\text{logistic}(-6.23*\delta_{edges} + .20*\delta_{popmil} +
0.34*\delta_{\text{6-10 years}}) \\
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) = \text{logistic}(-6.84*1 +
0.20*2.1 + 0.34*1) \\
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) = \text{logistic}(-6.08) =
\frac{1}{1 + e^{-(-6.08)}} = 0.0023
\]</span></p>
<p>The probability of a tie between these two LHDs with these
characteristics is 0.0023 or 0.23%. While this may seem low, the density
of the network was 0.0033, indicating that only 0.33% of possible
linkages exist, the likelihood of this particular connection is
therefore lower than might be expected.</p>
<h3 id="adding-interaction-terms">Adding interaction terms</h3>
<p>Interaction terms for nodal attributes account for the attributes of
both members of a dyad. The most commonly used interaction terms may be
those accounting for homophily and heterophily. Interaction terms
continue to treat each dyad as independent; models including interaction
terms continue to be dyadic independence models. Dyadic independence
models assume that each dyad is independent of all other dyads in the
model, so the likelihood of a link between A and B would be considered
independent from the likelihood of C and B, despite B being in both
dyads.</p>
<p>Based on the exploratory analysis, LHDs appear to form more
connections with other LHDs in the same state and conducting the same
programs. That is, there seems to be some homophily of state and
programming in connected dyads across the LHD network. Interaction terms
for these attributes can be used to test this hypothesis in a new
model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lhds_complete</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidygraph.data-imaginist.com/reference/tbl_graph.html'>as_tbl_graph</a></span><span class='op'>(</span><span class='va'>lhds</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidygraph.data-imaginist.com/reference/activate.html'>activate</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/complete.cases.html'>complete.cases</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span>.cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"hivscreen"</span>, <span class='st'>"nutrition"</span>, <span class='st'>"popmil"</span>, <span class='st'>"state"</span>, <span class='st'>"years"</span>, <span class='st'>"name"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/intergraph/man/asNetwork.html'>asNetwork</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>homophilymodel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>lhds_complete</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodecov</span><span class='op'>(</span><span class='st'>"popmil"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodefactor</span><span class='op'>(</span><span class='st'>"years"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"hivscreen"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"nutrition"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"state"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>summary.ergm.david</span><span class='op'>(</span><span class='va'>homophilymodel</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = lhds_complete ~ edges + nodecov(&quot;popmil&quot;) + nodefactor(&quot;years&quot;) + 
    nodematch(&quot;hivscreen&quot;) + nodematch(&quot;nutrition&quot;) + nodematch(&quot;state&quot;))

Maximum Likelihood Results:

                    Estimate Std. Error MCMC %    Wald      OR
edges               -9.47263    0.11980      0 -79.073   0.000
nodecov.popmil       0.36747    0.01980      0  18.555   1.444
nodefactor.years.1   0.17717    0.05018      0   3.531   1.194
nodefactor.years.2   0.32156    0.04700      0   6.841   1.379
nodefactor.years.3   0.28884    0.04483      0   6.443   1.335
nodematch.hivscreen  0.25651    0.04891      0   5.245   1.292
nodematch.nutrition  0.25032    0.04891      0   5.119   1.284
nodematch.state      6.27777    0.08717      0  72.018 532.597
                      Lower   Upper Pr(&gt;|z|)    
edges                 0.000   0.000  &lt; 1e-04 ***
nodecov.popmil        1.389   1.501  &lt; 1e-04 ***
nodefactor.years.1    1.082   1.317 0.000414 ***
nodefactor.years.2    1.258   1.512  &lt; 1e-04 ***
nodefactor.years.3    1.223   1.457  &lt; 1e-04 ***
nodematch.hivscreen   1.174   1.422  &lt; 1e-04 ***
nodematch.nutrition   1.167   1.414  &lt; 1e-04 ***
nodematch.state     448.951 631.828  &lt; 1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 1046106  on 754606  degrees of freedom
 Residual Deviance:   18273  on 754598  degrees of freedom
 
AIC: 18289  BIC: 18381  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>The model shows significant positive coefficients for state and
programming homophily in the network. That is, two LHDs in the same
state are more likely to be connected, as are two LHDs conducting the
same programming. For this example main effects for programming are not
entered as each LHD only has two possible values for these, both cannot
be entered due to the limited degrees of freedom available.</p>
<p>During the exploratory analyses there was an indication that program
homophily was different for LHDs conducting the program compared to
those not conducting the program. LHDs were more likely to have contact
with other LHDs conducting the same programs, but the converse was not
necessarily the case. Homophily can be estimated for each level of a
categorical variable; this is called differential homophily. By
specifying differential homophily for programs, homophily terms will be
included seperately for conducting and not conducting the program.
Differential homophily is shown by the use of <code>diff = TRUE</code>
following the name of the attribute in a <code>nodematch()</code>
term.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>diffhomophily</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>lhds_complete</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodecov</span><span class='op'>(</span><span class='st'>"popmil"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodefactor</span><span class='op'>(</span><span class='st'>"years"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"hivscreen"</span>, diff <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"nutrition"</span>, diff <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"state"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>summary.ergm.david</span><span class='op'>(</span><span class='va'>diffhomophily</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = lhds_complete ~ edges + nodecov(&quot;popmil&quot;) + nodefactor(&quot;years&quot;) + 
    nodematch(&quot;hivscreen&quot;, diff = TRUE) + nodematch(&quot;nutrition&quot;, 
    diff = TRUE) + nodematch(&quot;state&quot;))

Maximum Likelihood Results:

                       Estimate Std. Error MCMC %    Wald      OR
edges                 -9.490290   0.119672      0 -79.302   0.000
nodecov.popmil         0.335321   0.020506      0  16.353   1.398
nodefactor.years.1     0.181105   0.050219      0   3.606   1.199
nodefactor.years.2     0.327385   0.047126      0   6.947   1.387
nodefactor.years.3     0.338870   0.045209      0   7.496   1.403
nodematch.hivscreen.N -0.057548   0.064628      0  -0.890   0.944
nodematch.hivscreen.Y  0.419880   0.052098      0   8.059   1.522
nodematch.nutrition.N -0.004747   0.087566      0  -0.054   0.995
nodematch.nutrition.Y  0.208587   0.051083      0   4.083   1.232
nodematch.state        6.310615   0.086628      0  72.847 550.383
                        Lower   Upper Pr(&gt;|z|)    
edges                   0.000   0.000  &lt; 1e-04 ***
nodecov.popmil          1.343   1.456  &lt; 1e-04 ***
nodefactor.years.1      1.086   1.323 0.000311 ***
nodefactor.years.2      1.265   1.522  &lt; 1e-04 ***
nodefactor.years.3      1.284   1.533  &lt; 1e-04 ***
nodematch.hivscreen.N   0.832   1.072 0.373221    
nodematch.hivscreen.Y   1.374   1.685  &lt; 1e-04 ***
nodematch.nutrition.N   0.838   1.182 0.956767    
nodematch.nutrition.Y   1.115   1.362  &lt; 1e-04 ***
nodematch.state       464.436 652.235  &lt; 1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 1046106  on 754606  degrees of freedom
 Residual Deviance:   18172  on 754596  degrees of freedom
 
AIC: 18192  BIC: 18308  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>The output shows the category for each homophily term. The model
including differential homophily demonstrates a significant increase in
the likelihood of a tie between two LHDs conducting the specified
programming, but not between two LHDs that are both not conducting the
programming. It may be helpful to keep only the terms for program
homophily when the LHDs are both conducting the program and to drop
homophily terms for LHDs not conducting programming. To do this, the
terms to keep can be specified in the <code>nodematch()</code> command.
In this case not doing a program is coded as N and so comes first, the
first homophily term estimated will be two LHDs not doing the program
(N-N), with two doing the program (Y-Y) next. To keep only the homophily
term for two LHDs both conducting programs <code>keep = 2</code> can be
added to the <code>nodematch()</code> term.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>diffhomophily2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span><span class='op'>(</span><span class='va'>lhds_complete</span> <span class='op'>~</span> <span class='va'>edges</span> <span class='op'>+</span> <span class='fu'>nodecov</span><span class='op'>(</span><span class='st'>"popmil"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodefactor</span><span class='op'>(</span><span class='st'>"years"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"hivscreen"</span>, diff <span class='op'>=</span> <span class='cn'>TRUE</span>, keep <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"nutrition"</span>, diff <span class='op'>=</span> <span class='cn'>TRUE</span>, keep <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>nodematch</span><span class='op'>(</span><span class='st'>"state"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>summary.ergm.david</span><span class='op'>(</span><span class='va'>diffhomophily2</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call:
ergm(formula = lhds_complete ~ edges + nodecov(&quot;popmil&quot;) + nodefactor(&quot;years&quot;) + 
    nodematch(&quot;hivscreen&quot;, diff = TRUE, keep = 2) + nodematch(&quot;nutrition&quot;, 
    diff = TRUE, keep = 2) + nodematch(&quot;state&quot;))

Maximum Likelihood Results:

                      Estimate Std. Error MCMC %    Wald      OR
edges                 -9.51388    0.11631      0 -81.797   0.000
nodecov.popmil         0.33637    0.02045      0  16.445   1.400
nodefactor.years.1     0.18071    0.05022      0   3.598   1.198
nodefactor.years.2     0.32791    0.04710      0   6.962   1.388
nodefactor.years.3     0.33755    0.04518      0   7.471   1.402
nodematch.hivscreen.Y  0.44404    0.04512      0   9.841   1.559
nodematch.nutrition.Y  0.21602    0.04716      0   4.581   1.241
nodematch.state        6.30365    0.08630      0  73.046 546.561
                        Lower   Upper Pr(&gt;|z|)    
edges                   0.000   0.000  &lt; 1e-04 ***
nodecov.popmil          1.345   1.457  &lt; 1e-04 ***
nodefactor.years.1      1.086   1.322  0.00032 ***
nodefactor.years.2      1.266   1.522  &lt; 1e-04 ***
nodefactor.years.3      1.283   1.531  &lt; 1e-04 ***
nodematch.hivscreen.Y   1.427   1.703  &lt; 1e-04 ***
nodematch.nutrition.Y   1.132   1.361  &lt; 1e-04 ***
nodematch.state       461.510 647.287  &lt; 1e-04 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

     Null Deviance: 1046106  on 754606  degrees of freedom
 Residual Deviance:   18173  on 754598  degrees of freedom
 
AIC: 18189  BIC: 18281  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
<p>Homophily and differential homophily change statistics are similar to
main effects change statistics, although since the unit of interest is
now the dyad, there are only two possible values. The change statistics
can be denoted as follows:</p>
<p><span class="math display">\[
\delta_\text{hom} = 1 \text{ if } i \text{ and } j \text{ have the same
value for a categorical covariate} \\
\delta_\text{hom} = 0 \text{ otherwise}
\]</span></p>
<p><span class="math display">\[
\delta_\text{diff} = 1 \text{ if } i \text{ and } j \text{ have the same
value for a certain category of a categorical covariate} \\
\delta_\text{diff} = 0 \text{ otherwise}
\]</span></p>
<p>Calculating the probability of connection between two LHDs can
demonstrate the use of dyad-level terms. In addition to each LHD having
its own characteristics for leader experience and jurisdiction
population, the two LHDs in this dyad may match on state and nutrition
programming but may not match on HIV screeening. There are 10 terms in
this model:</p>
<ol type="1">
<li>100,000 constituents, leader with 1 year of experience, no HIV
screening, nutrition programming, in Missouri</li>
<li>2,000,000 constituents, leader with 7 years of experience, HIV
screening, nutrition programming, in Missouri</li>
</ol>
<p><span class="math display">\[
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) =
\text{logistic}(\theta_{edges}\delta_{edges} +
\theta_{popmil}\delta_{popmil} + \theta_{\text3-5
years}\delta_{\text{3-5 years}} + \theta_{\text{6-10
years}}\delta_{\text{6-10 years}} + \theta_{\text{&gt;10
years}}\delta_{\text{&gt;10 years}} + \theta_\text{HIV
hom}\delta_\text{HIV hom} + \theta_\text{Nut hom}\delta_\text{Nut hom} +
\theta_\text{State hom}\delta_\text{State hom}) \\
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) =
\text{logistic}(-9.51*\delta_{edges} + 0.34*\delta_{popmil} +
0.34*\delta_{\text{6-10 years}} + 0.22*\delta_\text{Nut hom} +
6.30*\delta_\text{State hom}) \\
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) = \text{logistic}(-9.51*1 +
0.34*2.1 + 0.34*1 + 0.22*1 + 6.30*1) \\
P(Y_{ij} = 1|n_{actors}, Y^{c}_{ij}) = \text{logistic}(-1.936) =
\frac{1}{1 + e^{-(-1.936)}} = 0.144
\]</span></p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
